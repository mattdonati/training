+ echo 'Beginning trial 02 of 10'
Beginning trial 02 of 10
+ echo ':::DLPAL /home/frank/mlperf-training_v5.0/sd/nvcr.io+nvdlfwea+mlperftv50+stable_diffusion-arm+20250416.sqsh 745 16 node[002-012,014-018] '\''unknown'\'' 16xXE9712x4GB200'
:::DLPAL /home/frank/mlperf-training_v5.0/sd/nvcr.io+nvdlfwea+mlperftv50+stable_diffusion-arm+20250416.sqsh 745 16 node[002-012,014-018] 'unknown' 16xXE9712x4GB200
++ srun -N1 -n1 --container-name=stable_diffusion_745 --no-container-mount-home --container-remap-root --container-writable mlperf-sysjson.sh
+ echo ':::SYSJSON {"submitter":"UNKNOWN_MLPERF_SUBMITTER","division":"closed","status":"Available on-premise","system_name":"UNKNOWN_MLPERF_SYSTEM_NAME","number_of_nodes":"16","host_processors_per_node":"2","host_processor_model_name":"Neoverse-V2","host_processor_core_count":"72","host_processor_vcpu_count":"","host_processor_frequency":"","host_processor_caches":"","host_processor_interconnect":"","host_memory_capacity":"1.7 TB","host_storage_type":"","host_storage_capacity":"","host_networking":"","host_networking_topology":"","host_memory_configuration":"","accelerators_per_node":"4","accelerator_model_name":"HGX GB200","accelerator_host_interconnect":"","accelerator_frequency":"","accelerator_on-chip_memories":"","accelerator_memory_configuration":"","accelerator_memory_capacity":"189471 MiB","accelerator_interconnect":"","accelerator_interconnect_topology":"","cooling":"","hw_notes":"","framework":"PyTorch Dell Release 25.04","framework_name":"","other_software_stack":{"cuda_version":"12.9.0.034","cuda_driver_version":"575.50","nccl_version":"2.26.3","cublas_version":"12.9.0.2","cudnn_version":"9.9.0.52","trt_version":"10.9.0.34+cuda12.8","dali_version":"1.48.0","mofed_version":"5.4-rdmacore50.0","openmpi_version":"4.1.7","kernel_version":"Linux 6.8.0-1024-nvidia-64k","nvidia_kernel_driver":"570.124.06"},"operating_system":"Ubuntu 24.04.2 LTS","sw_notes":""}'
:::SYSJSON {"submitter":"UNKNOWN_MLPERF_SUBMITTER","division":"closed","status":"Available on-premise","system_name":"UNKNOWN_MLPERF_SYSTEM_NAME","number_of_nodes":"16","host_processors_per_node":"2","host_processor_model_name":"Neoverse-V2","host_processor_core_count":"72","host_processor_vcpu_count":"","host_processor_frequency":"","host_processor_caches":"","host_processor_interconnect":"","host_memory_capacity":"1.7 TB","host_storage_type":"","host_storage_capacity":"","host_networking":"","host_networking_topology":"","host_memory_configuration":"","accelerators_per_node":"4","accelerator_model_name":"HGX GB200","accelerator_host_interconnect":"","accelerator_frequency":"","accelerator_on-chip_memories":"","accelerator_memory_configuration":"","accelerator_memory_capacity":"189471 MiB","accelerator_interconnect":"","accelerator_interconnect_topology":"","cooling":"","hw_notes":"","framework":"PyTorch Dell Release 25.04","framework_name":"","other_software_stack":{"cuda_version":"12.9.0.034","cuda_driver_version":"575.50","nccl_version":"2.26.3","cublas_version":"12.9.0.2","cudnn_version":"9.9.0.52","trt_version":"10.9.0.34+cuda12.8","dali_version":"1.48.0","mofed_version":"5.4-rdmacore50.0","openmpi_version":"4.1.7","kernel_version":"Linux 6.8.0-1024-nvidia-64k","nvidia_kernel_driver":"570.124.06"},"operating_system":"Ubuntu 24.04.2 LTS","sw_notes":""}
+ srun -N1 -n1 --container-name=stable_diffusion_745 --no-container-mount-home --container-remap-root --container-writable bash -c 'echo ":::GITCOMMITID ${GIT_COMMIT_ID} ${LAUNCHER_GIT_COMMIT_ID}"'
:::GITCOMMITID ecb36f93dd070ee7496f2ea33523b8f1d6b339b8 
+ [[ 1 -eq 1 ]]
+ srun --ntasks-per-node=1 --mpi=pmix bash -c 'echo -n '\''Clearing cache on '\'' && hostname && sync && sudo /sbin/sysctl vm.drop_caches=3'
srun: warning: can't honor --ntasks-per-node set to 1 which doesn't match the requested tasks 64 with the number of requested nodes 16. Ignoring --ntasks-per-node.
Clearing cache on node005
Clearing cache on node005
Clearing cache on node005
Clearing cache on node005
Clearing cache on node017
Clearing cache on node017
Clearing cache on node017
Clearing cache on node017
Clearing cache on node016
Clearing cache on node016
Clearing cache on node016
Clearing cache on node016
Clearing cache on node009
Clearing cache on node015
Clearing cache on node014
Clearing cache on node018
Clearing cache on node006
Clearing cache on node008
Clearing cache on node004
Clearing cache on node007
Clearing cache on node011
Clearing cache on node012
Clearing cache on node003
Clearing cache on node009
Clearing cache on node015
Clearing cache on node014
Clearing cache on node018
Clearing cache on node006
Clearing cache on node008
Clearing cache on node004
Clearing cache on node007
Clearing cache on node011
Clearing cache on node012
Clearing cache on node003
Clearing cache on node009
Clearing cache on node015
Clearing cache on node014
Clearing cache on node018
Clearing cache on node006
Clearing cache on node008
Clearing cache on node004
Clearing cache on node007
Clearing cache on node011
Clearing cache on node012
Clearing cache on node003
Clearing cache on node009
Clearing cache on node015
Clearing cache on node014
Clearing cache on node018
Clearing cache on node006
Clearing cache on node008
Clearing cache on node004
Clearing cache on node007
Clearing cache on node011
Clearing cache on node012
Clearing cache on node003
Clearing cache on node010
Clearing cache on node002
Clearing cache on node010
Clearing cache on node010
Clearing cache on node010
Clearing cache on node002
Clearing cache on node002
Clearing cache on node002
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
vm.drop_caches = 3
+ srun --ntasks-per-node=1 --mpi=pmix --container-name=stable_diffusion_745 --no-container-mount-home --container-remap-root --container-writable python -c '
from mlperf_logging import mllog
mllogger = mllog.get_mllogger()
mllogger.event(key=mllog.constants.CACHE_CLEAR, value=True)'
srun: warning: can't honor --ntasks-per-node set to 1 which doesn't match the requested tasks 64 with the number of requested nodes 16. Ignoring --ntasks-per-node.
:::MLLOG {"namespace": "", "time_ms": 1746099038588, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038588, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038588, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038588, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038598, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038598, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038598, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038598, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038604, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038604, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038604, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038604, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038614, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038614, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038614, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038614, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038618, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038618, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038618, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038618, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038623, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038623, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038623, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038623, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038626, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038626, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038626, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038626, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038624, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038624, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038624, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038624, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038628, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038628, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038628, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038628, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038638, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038649, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038649, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038649, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038649, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038657, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038657, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038657, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038657, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038670, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038670, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038670, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038670, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038793, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038819, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038793, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038793, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038793, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038819, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038819, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
:::MLLOG {"namespace": "", "time_ms": 1746099038819, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
+ export RANDOM_SEED=16244
+ RANDOM_SEED=16244
+ export EXP_NAME=stable-diffusion2-train-250501061129395518847-02
+ EXP_NAME=stable-diffusion2-train-250501061129395518847-02
+ set +e
++ date +%s
+ echo 'RUNANDTIME_START 1746099038'
RUNANDTIME_START 1746099038
+ srun -l --mpi=pmix --ntasks-per-node=4 --time=50 --container-name=stable_diffusion_745 --no-container-mount-home --container-remap-root --container-writable --container-mounts=/home/frank/results/16-XE9712-sd:/results,/mnt/data/mlperf_training_v5.0_ds/sd/datasets/laion-400m/webdataset-moments-filtered-encoded:/datasets,/mnt/data/mlperf_training_v5.0_ds/sd/datasets/coco2014:/coco2014/,/mnt/data/mlperf_training_v5.0_ds/sd/checkpoints/clip:/checkpoints/clip,/mnt/data/mlperf_training_v5.0_ds/sd/checkpoints/inception:/checkpoints/inception,/mnt/data/mlperf_training_v5.0_ds/sd/checkpoints/sd:/checkpoints/sd --container-workdir=/workspace/sd --container-env=MASTER_PORT,MASTER_ADDR slurm2pytorch ./run_and_time.sh
 0: RANDOM_SEED=16244
 0: :::MLLOG {"namespace": "", "time_ms": 1746099053066, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/sd/main.py", "lineno": 86}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099053791, "event_type": "POINT_IN_TIME", "key": "seed", "value": 3225429021, "metadata": {"file": "/workspace/sd/main.py", "lineno": 109}}
 0: GPU available: True (cuda), used: True
 0: TPU available: False, using: 0 TPU cores
 0: HPU available: False, using: 0 HPUs
 0: [NeMo E 2025-05-01 06:30:53 nemo_logging:417] You are running multi-node training without SLURM handling the processes. Please note that this is not tested in NeMo and could result in errors.
 0: Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/64
 3: Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/64
 1: Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/64
 2: Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/64
56: Initializing distributed: GLOBAL_RANK: 56, MEMBER: 57/64
59: Initializing distributed: GLOBAL_RANK: 59, MEMBER: 60/64
10: Initializing distributed: GLOBAL_RANK: 10, MEMBER: 11/64
 7: Initializing distributed: GLOBAL_RANK: 7, MEMBER: 8/64
 5: Initializing distributed: GLOBAL_RANK: 5, MEMBER: 6/64
58: Initializing distributed: GLOBAL_RANK: 58, MEMBER: 59/64
 4: Initializing distributed: GLOBAL_RANK: 4, MEMBER: 5/64
 6: Initializing distributed: GLOBAL_RANK: 6, MEMBER: 7/64
57: Initializing distributed: GLOBAL_RANK: 57, MEMBER: 58/64
11: Initializing distributed: GLOBAL_RANK: 11, MEMBER: 12/64
 8: Initializing distributed: GLOBAL_RANK: 8, MEMBER: 9/64
 9: Initializing distributed: GLOBAL_RANK: 9, MEMBER: 10/64
46: Initializing distributed: GLOBAL_RANK: 46, MEMBER: 47/64
47: Initializing distributed: GLOBAL_RANK: 47, MEMBER: 48/64
14: Initializing distributed: GLOBAL_RANK: 14, MEMBER: 15/64
44: Initializing distributed: GLOBAL_RANK: 44, MEMBER: 45/64
45: Initializing distributed: GLOBAL_RANK: 45, MEMBER: 46/64
13: Initializing distributed: GLOBAL_RANK: 13, MEMBER: 14/64
15: Initializing distributed: GLOBAL_RANK: 15, MEMBER: 16/64
12: Initializing distributed: GLOBAL_RANK: 12, MEMBER: 13/64
36: Initializing distributed: GLOBAL_RANK: 36, MEMBER: 37/64
62: Initializing distributed: GLOBAL_RANK: 62, MEMBER: 63/64
39: Initializing distributed: GLOBAL_RANK: 39, MEMBER: 40/64
61: Initializing distributed: GLOBAL_RANK: 61, MEMBER: 62/64
63: Initializing distributed: GLOBAL_RANK: 63, MEMBER: 64/64
38: Initializing distributed: GLOBAL_RANK: 38, MEMBER: 39/64
60: Initializing distributed: GLOBAL_RANK: 60, MEMBER: 61/64
51: Initializing distributed: GLOBAL_RANK: 51, MEMBER: 52/64
37: Initializing distributed: GLOBAL_RANK: 37, MEMBER: 38/64
50: Initializing distributed: GLOBAL_RANK: 50, MEMBER: 51/64
49: Initializing distributed: GLOBAL_RANK: 49, MEMBER: 50/64
48: Initializing distributed: GLOBAL_RANK: 48, MEMBER: 49/64
31: Initializing distributed: GLOBAL_RANK: 31, MEMBER: 32/64
30: Initializing distributed: GLOBAL_RANK: 30, MEMBER: 31/64
43: Initializing distributed: GLOBAL_RANK: 43, MEMBER: 44/64
42: Initializing distributed: GLOBAL_RANK: 42, MEMBER: 43/64
28: Initializing distributed: GLOBAL_RANK: 28, MEMBER: 29/64
40: Initializing distributed: GLOBAL_RANK: 40, MEMBER: 41/64
41: Initializing distributed: GLOBAL_RANK: 41, MEMBER: 42/64
29: Initializing distributed: GLOBAL_RANK: 29, MEMBER: 30/64
20: Initializing distributed: GLOBAL_RANK: 20, MEMBER: 21/64
21: Initializing distributed: GLOBAL_RANK: 21, MEMBER: 22/64
54: Initializing distributed: GLOBAL_RANK: 54, MEMBER: 55/64
53: Initializing distributed: GLOBAL_RANK: 53, MEMBER: 54/64
55: Initializing distributed: GLOBAL_RANK: 55, MEMBER: 56/64
52: Initializing distributed: GLOBAL_RANK: 52, MEMBER: 53/64
23: Initializing distributed: GLOBAL_RANK: 23, MEMBER: 24/64
22: Initializing distributed: GLOBAL_RANK: 22, MEMBER: 23/64
19: Initializing distributed: GLOBAL_RANK: 19, MEMBER: 20/64
18: Initializing distributed: GLOBAL_RANK: 18, MEMBER: 19/64
16: Initializing distributed: GLOBAL_RANK: 16, MEMBER: 17/64
17: Initializing distributed: GLOBAL_RANK: 17, MEMBER: 18/64
25: Initializing distributed: GLOBAL_RANK: 25, MEMBER: 26/64
27: Initializing distributed: GLOBAL_RANK: 27, MEMBER: 28/64
26: Initializing distributed: GLOBAL_RANK: 26, MEMBER: 27/64
24: Initializing distributed: GLOBAL_RANK: 24, MEMBER: 25/64
33: Initializing distributed: GLOBAL_RANK: 33, MEMBER: 34/64
32: Initializing distributed: GLOBAL_RANK: 32, MEMBER: 33/64
35: Initializing distributed: GLOBAL_RANK: 35, MEMBER: 36/64
34: Initializing distributed: GLOBAL_RANK: 34, MEMBER: 35/64
 0: ----------------------------------------------------------------------------------------------------
 0: distributed_backend=nccl
 0: All distributed processes registered. Starting with 64 processes
 0: ----------------------------------------------------------------------------------------------------
 0: 
 0: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 1: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
28: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
48: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
16: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 4: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 2: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 8: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 3: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
60: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
44: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
40: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
12: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
20: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
24: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
56: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
29: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
30: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
31: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
17: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
19: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
38: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
18: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 5: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
49: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 6: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
50: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 7: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
51: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
53: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
61: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
41: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
25: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
32: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
13: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
62: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
21: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
45: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
42: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
26: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 9: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
14: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
63: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
22: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
46: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
43: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
27: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
10: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
15: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
23: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
47: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
11: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
39: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
57: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
36: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
58: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
37: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
59: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
54: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
33: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
55: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
34: LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
52: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
35: LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084799, "event_type": "POINT_IN_TIME", "key": "gradient_accumulation_steps", "value": 1, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 271}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084814, "event_type": "POINT_IN_TIME", "key": "global_batch_size", "value": 512, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 275}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084814, "event_type": "POINT_IN_TIME", "key": "opt_name", "value": "adamw", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 279}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "opt_adamw_beta_1", "value": 0.9, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 280}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "opt_adamw_beta_2", "value": 0.999, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 281}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "opt_adamw_epsilon", "value": 1e-08, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 282}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "opt_adamw_weight_decay", "value": 0.01, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 283}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "opt_base_learning_rate", "value": 0.00011776, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 285}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_warmup_steps", "value": 1000, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 286}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "train_samples", "value": 6513144, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 291}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084815, "event_type": "POINT_IN_TIME", "key": "eval_samples", "value": 30000, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 292}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084816, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "stable_diffusion", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 294}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084816, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "Dell", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 294}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084816, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 294}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084816, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 294}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099084816, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "16xXE9712x4GB200", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 294}}
 0: 
 0:   | Name  | Type            | Params | Mode 
 0: --------------------------------------------------
 0: 0 | model | LatentDiffusion | 865 M  | train
 0: --------------------------------------------------
 0: 865 M     Trainable params
 0: 0         Non-trainable params
 0: 865 M     Total params
 0: 3,463.643 Total estimated model params size (MB)
 0: 993       Modules in train mode
 0: 482       Modules in eval mode
 2: SLURM auto-requeueing enabled. Setting signal handlers.
 3: SLURM auto-requeueing enabled. Setting signal handlers.
 9: SLURM auto-requeueing enabled. Setting signal handlers.
18: SLURM auto-requeueing enabled. Setting signal handlers.
 1: SLURM auto-requeueing enabled. Setting signal handlers.
 5: SLURM auto-requeueing enabled. Setting signal handlers.
49: SLURM auto-requeueing enabled. Setting signal handlers.
 0: SLURM auto-requeueing enabled. Setting signal handlers.
20: SLURM auto-requeueing enabled. Setting signal handlers.
29: SLURM auto-requeueing enabled. Setting signal handlers.
60: SLURM auto-requeueing enabled. Setting signal handlers.
44: SLURM auto-requeueing enabled. Setting signal handlers.
24: SLURM auto-requeueing enabled. Setting signal handlers.
33: SLURM auto-requeueing enabled. Setting signal handlers.
13: SLURM auto-requeueing enabled. Setting signal handlers.
52: SLURM auto-requeueing enabled. Setting signal handlers.
40: SLURM auto-requeueing enabled. Setting signal handlers.
38: SLURM auto-requeueing enabled. Setting signal handlers.
10: SLURM auto-requeueing enabled. Setting signal handlers.
11: SLURM auto-requeueing enabled. Setting signal handlers.
 6: SLURM auto-requeueing enabled. Setting signal handlers.
 8: SLURM auto-requeueing enabled. Setting signal handlers.
16: SLURM auto-requeueing enabled. Setting signal handlers.
 4: SLURM auto-requeueing enabled. Setting signal handlers.
17: SLURM auto-requeueing enabled. Setting signal handlers.
 7: SLURM auto-requeueing enabled. Setting signal handlers.
19: SLURM auto-requeueing enabled. Setting signal handlers.
50: SLURM auto-requeueing enabled. Setting signal handlers.
51: SLURM auto-requeueing enabled. Setting signal handlers.
48: SLURM auto-requeueing enabled. Setting signal handlers.
14: SLURM auto-requeueing enabled. Setting signal handlers.
54: SLURM auto-requeueing enabled. Setting signal handlers.
61: SLURM auto-requeueing enabled. Setting signal handlers.
21: SLURM auto-requeueing enabled. Setting signal handlers.
31: SLURM auto-requeueing enabled. Setting signal handlers.
46: SLURM auto-requeueing enabled. Setting signal handlers.
41: SLURM auto-requeueing enabled. Setting signal handlers.
26: SLURM auto-requeueing enabled. Setting signal handlers.
37: SLURM auto-requeueing enabled. Setting signal handlers.
56: SLURM auto-requeueing enabled. Setting signal handlers.
15: SLURM auto-requeueing enabled. Setting signal handlers.
53: SLURM auto-requeueing enabled. Setting signal handlers.
62: SLURM auto-requeueing enabled. Setting signal handlers.
22: SLURM auto-requeueing enabled. Setting signal handlers.
28: SLURM auto-requeueing enabled. Setting signal handlers.
47: SLURM auto-requeueing enabled. Setting signal handlers.
42: SLURM auto-requeueing enabled. Setting signal handlers.
27: SLURM auto-requeueing enabled. Setting signal handlers.
39: SLURM auto-requeueing enabled. Setting signal handlers.
34: SLURM auto-requeueing enabled. Setting signal handlers.
12: SLURM auto-requeueing enabled. Setting signal handlers.
55: SLURM auto-requeueing enabled. Setting signal handlers.
63: SLURM auto-requeueing enabled. Setting signal handlers.
23: SLURM auto-requeueing enabled. Setting signal handlers.
30: SLURM auto-requeueing enabled. Setting signal handlers.
45: SLURM auto-requeueing enabled. Setting signal handlers.
43: SLURM auto-requeueing enabled. Setting signal handlers.
25: SLURM auto-requeueing enabled. Setting signal handlers.
36: SLURM auto-requeueing enabled. Setting signal handlers.
35: SLURM auto-requeueing enabled. Setting signal handlers.
32: SLURM auto-requeueing enabled. Setting signal handlers.
57: SLURM auto-requeueing enabled. Setting signal handlers.
59: SLURM auto-requeueing enabled. Setting signal handlers.
58: SLURM auto-requeueing enabled. Setting signal handlers.
 0: CUDAGraphCallback: disable autocast cache.
 0: CUDAGraphCallback: disable autocast cache.
44: ninja: no work to do.
12: ninja: no work to do.
45: ninja: no work to do.
28: ninja: no work to do.
63: ninja: no work to do.
11: ninja: no work to do.
29: ninja: no work to do.
56: ninja: no work to do.
14: ninja: no work to do.
46: ninja: no work to do.
57: ninja: no work to do.
62: ninja: no work to do.
48: ninja: no work to do.
43: ninja: no work to do.
 6: ninja: no work to do.
50: ninja: no work to do.
59: ninja: no work to do.
37: ninja: no work to do.
54: ninja: no work to do.
40: ninja: no work to do.
49: ninja: no work to do.
55: ninja: no work to do.
 0: ninja: no work to do.
24: ninja: no work to do.
16: ninja: no work to do.
26: ninja: no work to do.
 2: ninja: no work to do.
18: ninja: no work to do.
32: ninja: no work to do.
 1: ninja: no work to do.
17: ninja: no work to do.
33: ninja: no work to do.
27: ninja: no work to do.
22: ninja: no work to do.
23: ninja: no work to do.
21: ninja: no work to do.
20: ninja: no work to do.
52: ninja: no work to do.
38: ninja: no work to do.
 0: CUDAGraphCallback: set optimizer.zero_grad as nop during graph capturing.
 0: :::MLLOG {"namespace": "", "time_ms": 1746099159075, "event_type": "INTERVAL_END", "key": "init_stop", "value": null, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 426}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099159076, "event_type": "INTERVAL_START", "key": "run_start", "value": null, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 426}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099159076, "event_type": "INTERVAL_START", "key": "block_start", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 436, "samples_count": 0}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099196240, "event_type": "INTERVAL_END", "key": "block_stop", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 470, "samples_count": 0}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099196241, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 4681.492350374672, "train_step_time": 0.10936683469300625, "max_memory_usage": 11.123}, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 494, "step_num": 0}}
 0: Epoch 0, global step 1000: 'timestamp' reached 1746099196239.00000 (best 1746099196239.00000), saving model to '/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/stable-diffusion2-train-250501061129395518847-02--timestamp=1746099196239.0-step=1000-consumed_samples=512000.0.ckpt' as top 1
 0: :::MLLOG {"namespace": "", "time_ms": 1746099196778, "event_type": "INTERVAL_START", "key": "block_start", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 436, "samples_count": 512000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099234972, "event_type": "INTERVAL_END", "key": "block_stop", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 470, "samples_count": 512000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099234973, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 13218.926899078957, "train_step_time": 0.03873234218699508, "max_memory_usage": 11.123}, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 494, "step_num": 1000}}
 0: Epoch 1, global step 2000: 'timestamp' reached 1746099234972.00000 (best 1746099196239.00000), saving model to '/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/stable-diffusion2-train-250501061129395518847-02--timestamp=1746099234972.0-step=2000-consumed_samples=1024000.0.ckpt' as top 2
 0: :::MLLOG {"namespace": "", "time_ms": 1746099235458, "event_type": "INTERVAL_START", "key": "block_start", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 436, "samples_count": 1024000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099271850, "event_type": "INTERVAL_END", "key": "block_stop", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 470, "samples_count": 1024000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099271850, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 13883.774037460222, "train_step_time": 0.03687758088100236, "max_memory_usage": 11.123}, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 494, "step_num": 2000}}
 0: Epoch 1, global step 3000: 'timestamp' reached 1746099271849.00000 (best 1746099196239.00000), saving model to '/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/stable-diffusion2-train-250501061129395518847-02--timestamp=1746099271849.0-step=3000-consumed_samples=1536000.0.ckpt' as top 3
 0: :::MLLOG {"namespace": "", "time_ms": 1746099272310, "event_type": "INTERVAL_START", "key": "block_start", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 436, "samples_count": 1536000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099308572, "event_type": "INTERVAL_END", "key": "block_stop", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 470, "samples_count": 1536000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099308572, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 13942.645317302704, "train_step_time": 0.03672186936897924, "max_memory_usage": 11.123}, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 494, "step_num": 3000}}
 0: Epoch 2, global step 4000: 'timestamp' reached 1746099308571.00000 (best 1746099196239.00000), saving model to '/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/stable-diffusion2-train-250501061129395518847-02--timestamp=1746099308571.0-step=4000-consumed_samples=2048000.0.ckpt' as top 4
 0: :::MLLOG {"namespace": "", "time_ms": 1746099309029, "event_type": "INTERVAL_START", "key": "block_start", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 436, "samples_count": 2048000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099345106, "event_type": "INTERVAL_END", "key": "block_stop", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 470, "samples_count": 2048000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099345107, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 14014.040705757281, "train_step_time": 0.03653478755700053, "max_memory_usage": 11.123}, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 494, "step_num": 4000}}
 0: Epoch 3, global step 5000: 'timestamp' reached 1746099345106.00000 (best 1746099196239.00000), saving model to '/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/stable-diffusion2-train-250501061129395518847-02--timestamp=1746099345106.0-step=5000-consumed_samples=2560000.0.ckpt' as top 5
 0: :::MLLOG {"namespace": "", "time_ms": 1746099345565, "event_type": "INTERVAL_START", "key": "block_start", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 436, "samples_count": 2560000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099380966, "event_type": "INTERVAL_END", "key": "block_stop", "value": "training_step", "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 470, "samples_count": 2560000}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099380966, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 14277.919651858017, "train_step_time": 0.035859565853024834, "max_memory_usage": 11.123}, "metadata": {"file": "/workspace/sd/callbacks.py", "lineno": 494, "step_num": 5000}}
 0: Epoch 3, global step 6000: 'timestamp' reached 1746099380965.00000 (best 1746099196239.00000), saving model to '/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/stable-diffusion2-train-250501061129395518847-02--timestamp=1746099380965.0-step=6000-consumed_samples=3072000.0.ckpt' as top 6
 0: `Trainer.fit` stopped: `max_steps=6000` reached.
 4: [rank4]:[W501 06:36:33.687955357 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 0: [rank0]:[W501 06:36:33.987865467 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 8: [rank8]:[W501 06:36:33.998663953 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
12: [rank12]:[W501 06:36:34.004955003 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
16: [rank16]:[W501 06:36:34.230231321 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
20: [rank20]:[W501 06:36:34.204054319 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
24: [rank24]:[W501 06:36:34.557718100 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
28: [rank28]:[W501 06:36:34.135753161 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
32: [rank32]:[W501 06:36:34.150358257 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
36: [rank36]:[W501 06:36:34.121075364 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
40: [rank40]:[W501 06:36:34.997624806 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
44: [rank44]:[W501 06:36:34.752321186 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
52: [rank52]:[W501 06:36:34.211761228 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
48: [rank48]:[W501 06:36:34.128132939 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
56: [rank56]:[W501 06:36:34.280817148 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
60: [rank60]:[W501 06:36:34.633972282 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 1: [rank1]:[W501 06:36:34.469543571 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 2: [rank2]:[W501 06:36:34.479597139 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 3: [rank3]:[W501 06:36:34.489654707 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 6: [rank6]:[W501 06:36:34.235126004 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 5: [rank5]:[W501 06:36:34.241157962 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 7: [rank7]:[W501 06:36:34.245135779 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 9: [rank9]:[W501 06:36:34.557704616 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
10: [rank10]:[W501 06:36:34.567746226 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
11: [rank11]:[W501 06:36:34.577799547 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
13: [rank13]:[W501 06:36:34.557152772 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
14: [rank14]:[W501 06:36:34.567225064 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
15: [rank15]:[W501 06:36:34.577292427 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
18: [rank18]:[W501 06:36:34.790536854 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
17: [rank17]:[W501 06:36:34.790743254 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
19: [rank19]:[W501 06:36:34.807025264 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
22: [rank22]:[W501 06:36:34.792051006 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
25: [rank25]:[W501 06:36:34.097144530 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
23: [rank23]:[W501 06:36:34.792064542 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
26: [rank26]:[W501 06:36:34.107439585 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
29: [rank29]:[W501 06:36:34.655345950 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
27: [rank27]:[W501 06:36:34.107557280 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
30: [rank30]:[W501 06:36:34.665365774 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
31: [rank31]:[W501 06:36:34.665453870 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
33: [rank33]:[W501 06:36:34.648272732 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
34: [rank34]:[W501 06:36:34.648317948 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
35: [rank35]:[W501 06:36:34.658354302 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
37: [rank37]:[W501 06:36:34.600590407 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
38: [rank38]:[W501 06:36:34.600841702 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
39: [rank39]:[W501 06:36:34.600837414 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
41: [rank41]:[W501 06:36:34.457294356 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
42: [rank42]:[W501 06:36:34.457342804 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
43: [rank43]:[W501 06:36:34.457582868 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
45: [rank45]:[W501 06:36:34.192123252 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
46: [rank46]:[W501 06:36:34.192165492 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
47: [rank47]:[W501 06:36:34.192248148 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
49: [rank49]:[W501 06:36:34.538121448 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
50: [rank50]:[W501 06:36:34.548142302 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
51: [rank51]:[W501 06:36:34.558204597 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
54: [rank54]:[W501 06:36:34.662193585 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
53: [rank53]:[W501 06:36:34.662227345 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
55: [rank55]:[W501 06:36:34.672254535 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
57: [rank57]:[W501 06:36:34.670827344 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
58: [rank58]:[W501 06:36:34.670867056 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
61: [rank61]:[W501 06:36:34.004084599 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
62: [rank62]:[W501 06:36:34.014158536 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
63: [rank63]:[W501 06:36:34.014184264 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
59: [rank59]:[W501 06:36:35.922393098 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
21: [rank21]:[W501 06:36:35.165987499 ProcessGroupNCCL.cpp:1477] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
 0: CKPT_PATH=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/
 0: Using 16bit Automatic Mixed Precision (AMP)
 0: GPU available: True (cuda), used: True
 0: TPU available: False, using: 0 TPU cores
 0: HPU available: False, using: 0 HPUs
 0: setting number of microbatches to constant 1
57: Initializing distributed: GLOBAL_RANK: 57, MEMBER: 58/64
33: Initializing distributed: GLOBAL_RANK: 33, MEMBER: 34/64
56: Initializing distributed: GLOBAL_RANK: 56, MEMBER: 57/64
38: Initializing distributed: GLOBAL_RANK: 38, MEMBER: 39/64
58: Initializing distributed: GLOBAL_RANK: 58, MEMBER: 59/64
22: Initializing distributed: GLOBAL_RANK: 22, MEMBER: 23/64
23: Initializing distributed: GLOBAL_RANK: 23, MEMBER: 24/64
27: Initializing distributed: GLOBAL_RANK: 27, MEMBER: 28/64
24: Initializing distributed: GLOBAL_RANK: 24, MEMBER: 25/64
45: Initializing distributed: GLOBAL_RANK: 45, MEMBER: 46/64
25: Initializing distributed: GLOBAL_RANK: 25, MEMBER: 26/64
26: Initializing distributed: GLOBAL_RANK: 26, MEMBER: 27/64
41: Initializing distributed: GLOBAL_RANK: 41, MEMBER: 42/64
42: Initializing distributed: GLOBAL_RANK: 42, MEMBER: 43/64
44: Initializing distributed: GLOBAL_RANK: 44, MEMBER: 45/64
63: Initializing distributed: GLOBAL_RANK: 63, MEMBER: 64/64
47: Initializing distributed: GLOBAL_RANK: 47, MEMBER: 48/64
40: Initializing distributed: GLOBAL_RANK: 40, MEMBER: 41/64
43: Initializing distributed: GLOBAL_RANK: 43, MEMBER: 44/64
48: Initializing distributed: GLOBAL_RANK: 48, MEMBER: 49/64
46: Initializing distributed: GLOBAL_RANK: 46, MEMBER: 47/64
49: Initializing distributed: GLOBAL_RANK: 49, MEMBER: 50/64
50: Initializing distributed: GLOBAL_RANK: 50, MEMBER: 51/64
51: Initializing distributed: GLOBAL_RANK: 51, MEMBER: 52/64
31: Initializing distributed: GLOBAL_RANK: 31, MEMBER: 32/64
21: Initializing distributed: GLOBAL_RANK: 21, MEMBER: 22/64
 1: Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/64
29: Initializing distributed: GLOBAL_RANK: 29, MEMBER: 30/64
17: Initializing distributed: GLOBAL_RANK: 17, MEMBER: 18/64
32: Initializing distributed: GLOBAL_RANK: 32, MEMBER: 33/64
10: Initializing distributed: GLOBAL_RANK: 10, MEMBER: 11/64
30: Initializing distributed: GLOBAL_RANK: 30, MEMBER: 31/64
60: Initializing distributed: GLOBAL_RANK: 60, MEMBER: 61/64
28: Initializing distributed: GLOBAL_RANK: 28, MEMBER: 29/64
59: Initializing distributed: GLOBAL_RANK: 59, MEMBER: 60/64
16: Initializing distributed: GLOBAL_RANK: 16, MEMBER: 17/64
 8: Initializing distributed: GLOBAL_RANK: 8, MEMBER: 9/64
15: Initializing distributed: GLOBAL_RANK: 15, MEMBER: 16/64
 2: Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/64
61: Initializing distributed: GLOBAL_RANK: 61, MEMBER: 62/64
12: Initializing distributed: GLOBAL_RANK: 12, MEMBER: 13/64
19: Initializing distributed: GLOBAL_RANK: 19, MEMBER: 20/64
11: Initializing distributed: GLOBAL_RANK: 11, MEMBER: 12/64
 9: Initializing distributed: GLOBAL_RANK: 9, MEMBER: 10/64
18: Initializing distributed: GLOBAL_RANK: 18, MEMBER: 19/64
35: Initializing distributed: GLOBAL_RANK: 35, MEMBER: 36/64
62: Initializing distributed: GLOBAL_RANK: 62, MEMBER: 63/64
14: Initializing distributed: GLOBAL_RANK: 14, MEMBER: 15/64
36: Initializing distributed: GLOBAL_RANK: 36, MEMBER: 37/64
37: Initializing distributed: GLOBAL_RANK: 37, MEMBER: 38/64
 3: Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/64
 0: Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/64
34: Initializing distributed: GLOBAL_RANK: 34, MEMBER: 35/64
39: Initializing distributed: GLOBAL_RANK: 39, MEMBER: 40/64
53: Initializing distributed: GLOBAL_RANK: 53, MEMBER: 54/64
52: Initializing distributed: GLOBAL_RANK: 52, MEMBER: 53/64
20: Initializing distributed: GLOBAL_RANK: 20, MEMBER: 21/64
54: Initializing distributed: GLOBAL_RANK: 54, MEMBER: 55/64
 4: Initializing distributed: GLOBAL_RANK: 4, MEMBER: 5/64
 6: Initializing distributed: GLOBAL_RANK: 6, MEMBER: 7/64
55: Initializing distributed: GLOBAL_RANK: 55, MEMBER: 56/64
 7: Initializing distributed: GLOBAL_RANK: 7, MEMBER: 8/64
 5: Initializing distributed: GLOBAL_RANK: 5, MEMBER: 6/64
13: Initializing distributed: GLOBAL_RANK: 13, MEMBER: 14/64
 0: ----------------------------------------------------------------------------------------------------
 0: distributed_backend=nccl
 0: All distributed processes registered. Starting with 64 processes
 0: ----------------------------------------------------------------------------------------------------
 0: 
 0: [rank0]:[W501 06:37:11.118227992 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
23: [rank23]:[W501 06:37:11.300070651 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 23]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
62: [rank62]:[W501 06:37:11.441370468 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 62]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 8: [rank8]:[W501 06:37:11.243432020 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 8]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
24: [rank24]:[W501 06:37:11.670518608 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 24]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
21: [rank21]:[W501 06:37:11.366248770 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 21]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 9: [rank9]:[W501 06:37:11.250393380 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 9]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
44: [rank44]:[W501 06:37:11.716569157 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 44]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
30: [rank30]:[W501 06:37:11.235563741 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 30]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
37: [rank37]:[W501 06:37:11.169965222 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 37]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 4: [rank4]:[W501 06:37:11.999020674 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 4]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 6: [rank6]:[W501 06:37:11.999020610 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 6]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
57: [rank57]:[W501 06:37:11.177689491 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 57]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
56: [rank56]:[W501 06:37:11.177716851 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 56]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
50: [rank50]:[W501 06:37:11.101246901 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 50]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
49: [rank49]:[W501 06:37:11.108417934 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 49]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
40: [rank40]:[W501 06:37:11.044411138 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 40]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
16: [rank16]:[W501 06:37:11.486900412 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 16]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
19: [rank19]:[W501 06:37:11.486984188 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 19]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
52: [rank52]:[W501 06:37:11.236984989 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 52]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
35: [rank35]:[W501 06:37:11.285289089 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 35]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
17: [rank17]:[W501 06:37:11.495059224 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 17]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
18: [rank18]:[W501 06:37:11.495133656 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 18]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
43: [rank43]:[W501 06:37:11.075058206 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 43]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
42: [rank42]:[W501 06:37:11.075150014 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 42]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
53: [rank53]:[W501 06:37:11.257936777 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 53]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 2: [rank2]:[W501 06:37:11.353075635 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
54: [rank54]:[W501 06:37:11.257974537 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 54]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
34: [rank34]:[W501 06:37:11.306187619 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 34]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
33: [rank33]:[W501 06:37:11.306244899 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 33]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 1: [rank1]:[W501 06:37:11.361018419 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 3: [rank3]:[W501 06:37:11.361031891 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
22: [rank22]:[W501 06:37:11.499164848 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 22]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
20: [rank20]:[W501 06:37:11.499596207 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 20]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
26: [rank26]:[W501 06:37:11.806724549 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 26]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
27: [rank27]:[W501 06:37:11.814276312 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 27]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
61: [rank61]:[W501 06:37:11.599606653 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 61]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
63: [rank63]:[W501 06:37:11.607634225 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 63]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
60: [rank60]:[W501 06:37:11.607680561 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 60]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
48: [rank48]:[W501 06:37:11.204019476 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 48]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
29: [rank29]:[W501 06:37:11.372760725 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 29]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
31: [rank31]:[W501 06:37:11.373009557 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 31]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
28: [rank28]:[W501 06:37:11.373294868 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 28]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
12: [rank12]:[W501 06:37:11.377964869 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 12]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
47: [rank47]:[W501 06:37:11.878904036 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 47]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
45: [rank45]:[W501 06:37:11.879412803 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 45]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
46: [rank46]:[W501 06:37:11.879691171 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 46]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
41: [rank41]:[W501 06:37:11.158541032 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 41]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
36: [rank36]:[W501 06:37:11.315318957 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 36]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
38: [rank38]:[W501 06:37:11.315322189 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 38]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
39: [rank39]:[W501 06:37:11.315319181 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 39]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
10: [rank10]:[W501 06:37:11.429185233 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 10]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
11: [rank11]:[W501 06:37:11.429201809 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 11]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
55: [rank55]:[W501 06:37:11.340454526 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 55]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
32: [rank32]:[W501 06:37:11.389286480 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 32]  using GPU 0 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
58: [rank58]:[W501 06:37:11.338312046 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 58]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
59: [rank59]:[W501 06:37:11.338311758 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 59]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 7: [rank7]:[W501 06:37:11.178358105 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 7]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 5: [rank5]:[W501 06:37:11.178376249 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 5]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
51: [rank51]:[W501 06:37:11.286232966 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 51]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
15: [rank15]:[W501 06:37:11.527574207 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 15]  using GPU 3 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
25: [rank25]:[W501 06:37:11.998572697 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 25]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
14: [rank14]:[W501 06:37:11.536263974 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 14]  using GPU 2 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
13: [rank13]:[W501 06:37:11.731198527 ProcessGroupNCCL.cpp:4751] [PG ID 0 PG GUID 0 Rank 13]  using GPU 1 as device used by this process is currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. You can pecify device_id in init_process_group() to force use of a particular device.
 0: :::MLLOG {"namespace": "", "time_ms": 1746099436356, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/sd/infer_and_eval.py", "lineno": 98, "samples_count": 1024000}}
32: ninja: no work to do.
56: ninja: no work to do.
 6: ninja: no work to do.
55: ninja: no work to do.
26: ninja: no work to do.
53: ninja: no work to do.
21: ninja: no work to do.
48: ninja: no work to do.
27: ninja: no work to do.
14: ninja: no work to do.
45: ninja: no work to do.
18: ninja: no work to do.
30: ninja: no work to do.
63: ninja: no work to do.
41: ninja: no work to do.
38: ninja: no work to do.
 3: ninja: no work to do.
23: ninja: no work to do.
10: ninja: no work to do.
52: ninja: no work to do.
57: ninja: no work to do.
33: ninja: no work to do.
 5: ninja: no work to do.
50: ninja: no work to do.
25: ninja: no work to do.
54: ninja: no work to do.
13: ninja: no work to do.
 0: :::MLLOG {"namespace": "", "time_ms": 1746099536426, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 134.31657087703957, "metadata": {"file": "/workspace/sd/infer_and_eval.py", "lineno": 194, "samples_count": 1024000, "metric": "FID"}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099552695, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.11601826548576355, "metadata": {"file": "/workspace/sd/infer_and_eval.py", "lineno": 224, "samples_count": 1024000, "metric": "CLIP"}}
 0: :::MLLOG {"namespace": "", "time_ms": 1746099552695, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/sd/infer_and_eval.py", "lineno": 235, "samples_count": 1024000}}
 0: Using 16bit Automatic Mixed Precision (AMP)
 0: GPU available: True (cuda), used: True
 0: TPU available: False, using: 0 TPU cores
 0: HPU available: False, using: 0 HPUs
 0: :::MLLOG {"namespace": "", "time_ms": 1746099565340, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/sd/infer_and_eval.py", "lineno": 98, "samples_count": 1536000}}
13: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
13: [rank13]: Traceback (most recent call last):
13: [rank13]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
13: [rank13]:     main()
13: [rank13]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
13: [rank13]:     _run_hydra(
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
13: [rank13]:     _run_app(
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
13: [rank13]:     run_and_report(
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
13: [rank13]:     raise ex
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
13: [rank13]:     return func()
13: [rank13]:            ^^^^^^
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
13: [rank13]:     lambda: hydra.run(
13: [rank13]:             ^^^^^^^^^^
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
13: [rank13]:     _ = ret.return_value
13: [rank13]:         ^^^^^^^^^^^^^^^^
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
13: [rank13]:     raise self._return_value
13: [rank13]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
13: [rank13]:     ret.return_value = task_function(task_cfg)
13: [rank13]:                        ^^^^^^^^^^^^^^^^^^^^^^^
13: [rank13]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
13: [rank13]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
13: [rank13]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13: [rank13]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
13: [rank13]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
13: [rank13]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13: [rank13]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
13: [rank13]:     raise ValueError("Imaginary component {}".format(m))
13: [rank13]: ValueError: Imaginary component 0.0029952042492374167
20: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
20: [rank20]: Traceback (most recent call last):
20: [rank20]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
20: [rank20]:     main()
20: [rank20]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
20: [rank20]:     _run_hydra(
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
20: [rank20]:     _run_app(
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
20: [rank20]:     run_and_report(
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
20: [rank20]:     raise ex
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
20: [rank20]:     return func()
20: [rank20]:            ^^^^^^
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
20: [rank20]:     lambda: hydra.run(
20: [rank20]:             ^^^^^^^^^^
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
20: [rank20]:     _ = ret.return_value
20: [rank20]:         ^^^^^^^^^^^^^^^^
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
20: [rank20]:     raise self._return_value
20: [rank20]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
20: [rank20]:     ret.return_value = task_function(task_cfg)
20: [rank20]:                        ^^^^^^^^^^^^^^^^^^^^^^^
20: [rank20]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
20: [rank20]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
20: [rank20]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20: [rank20]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
20: [rank20]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
20: [rank20]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20: [rank20]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
20: [rank20]:     raise ValueError("Imaginary component {}".format(m))
20: [rank20]: ValueError: Imaginary component 0.0029952042492374167
15: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
15: [rank15]: Traceback (most recent call last):
15: [rank15]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
15: [rank15]:     main()
15: [rank15]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
15: [rank15]:     _run_hydra(
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
15: [rank15]:     _run_app(
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
15: [rank15]:     run_and_report(
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
15: [rank15]:     raise ex
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
15: [rank15]:     return func()
15: [rank15]:            ^^^^^^
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
15: [rank15]:     lambda: hydra.run(
15: [rank15]:             ^^^^^^^^^^
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
15: [rank15]:     _ = ret.return_value
15: [rank15]:         ^^^^^^^^^^^^^^^^
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
15: [rank15]:     raise self._return_value
15: [rank15]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
15: [rank15]:     ret.return_value = task_function(task_cfg)
15: [rank15]:                        ^^^^^^^^^^^^^^^^^^^^^^^
15: [rank15]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
15: [rank15]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
15: [rank15]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15: [rank15]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
15: [rank15]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
15: [rank15]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15: [rank15]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
15: [rank15]:     raise ValueError("Imaginary component {}".format(m))
15: [rank15]: ValueError: Imaginary component 0.0029952042492374167
21: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
21: [rank21]: Traceback (most recent call last):
21: [rank21]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
21: [rank21]:     main()
21: [rank21]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
21: [rank21]:     _run_hydra(
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
21: [rank21]:     _run_app(
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
21: [rank21]:     run_and_report(
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
21: [rank21]:     raise ex
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
21: [rank21]:     return func()
21: [rank21]:            ^^^^^^
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
21: [rank21]:     lambda: hydra.run(
21: [rank21]:             ^^^^^^^^^^
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
21: [rank21]:     _ = ret.return_value
21: [rank21]:         ^^^^^^^^^^^^^^^^
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
21: [rank21]:     raise self._return_value
21: [rank21]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
21: [rank21]:     ret.return_value = task_function(task_cfg)
21: [rank21]:                        ^^^^^^^^^^^^^^^^^^^^^^^
21: [rank21]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
21: [rank21]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
21: [rank21]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21: [rank21]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
21: [rank21]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
21: [rank21]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21: [rank21]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
21: [rank21]:     raise ValueError("Imaginary component {}".format(m))
21: [rank21]: ValueError: Imaginary component 0.0029952042492374167
52: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
52: [rank52]: Traceback (most recent call last):
52: [rank52]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
52: [rank52]:     main()
52: [rank52]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
52: [rank52]:     _run_hydra(
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
52: [rank52]:     _run_app(
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
52: [rank52]:     run_and_report(
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
52: [rank52]:     raise ex
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
52: [rank52]:     return func()
52: [rank52]:            ^^^^^^
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
52: [rank52]:     lambda: hydra.run(
52: [rank52]:             ^^^^^^^^^^
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
52: [rank52]:     _ = ret.return_value
52: [rank52]:         ^^^^^^^^^^^^^^^^
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
52: [rank52]:     raise self._return_value
52: [rank52]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
52: [rank52]:     ret.return_value = task_function(task_cfg)
52: [rank52]:                        ^^^^^^^^^^^^^^^^^^^^^^^
52: [rank52]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
52: [rank52]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
52: [rank52]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
52: [rank52]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
52: [rank52]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
52: [rank52]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
52: [rank52]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
52: [rank52]:     raise ValueError("Imaginary component {}".format(m))
52: [rank52]: ValueError: Imaginary component 0.0029952042492374167
59: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
59: [rank59]: Traceback (most recent call last):
59: [rank59]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
59: [rank59]:     main()
59: [rank59]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
59: [rank59]:     _run_hydra(
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
59: [rank59]:     _run_app(
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
59: [rank59]:     run_and_report(
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
59: [rank59]:     raise ex
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
59: [rank59]:     return func()
59: [rank59]:            ^^^^^^
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
59: [rank59]:     lambda: hydra.run(
59: [rank59]:             ^^^^^^^^^^
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
59: [rank59]:     _ = ret.return_value
59: [rank59]:         ^^^^^^^^^^^^^^^^
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
59: [rank59]:     raise self._return_value
59: [rank59]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
59: [rank59]:     ret.return_value = task_function(task_cfg)
59: [rank59]:                        ^^^^^^^^^^^^^^^^^^^^^^^
59: [rank59]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
59: [rank59]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
59: [rank59]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
59: [rank59]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
59: [rank59]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
59: [rank59]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
59: [rank59]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
59: [rank59]:     raise ValueError("Imaginary component {}".format(m))
59: [rank59]: ValueError: Imaginary component 0.0029952042492374167
22: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
22: [rank22]: Traceback (most recent call last):
22: [rank22]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
22: [rank22]:     main()
22: [rank22]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
22: [rank22]:     _run_hydra(
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
22: [rank22]:     _run_app(
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
22: [rank22]:     run_and_report(
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
22: [rank22]:     raise ex
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
22: [rank22]:     return func()
22: [rank22]:            ^^^^^^
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
22: [rank22]:     lambda: hydra.run(
22: [rank22]:             ^^^^^^^^^^
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
22: [rank22]:     _ = ret.return_value
22: [rank22]:         ^^^^^^^^^^^^^^^^
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
22: [rank22]:     raise self._return_value
22: [rank22]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
22: [rank22]:     ret.return_value = task_function(task_cfg)
22: [rank22]:                        ^^^^^^^^^^^^^^^^^^^^^^^
22: [rank22]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
22: [rank22]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
22: [rank22]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22: [rank22]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
22: [rank22]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
22: [rank22]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22: [rank22]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
22: [rank22]:     raise ValueError("Imaginary component {}".format(m))
22: [rank22]: ValueError: Imaginary component 0.0029952042492374167
14: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
14: [rank14]: Traceback (most recent call last):
14: [rank14]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
14: [rank14]:     main()
14: [rank14]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
14: [rank14]:     _run_hydra(
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
14: [rank14]:     _run_app(
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
14: [rank14]:     run_and_report(
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
14: [rank14]:     raise ex
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
14: [rank14]:     return func()
14: [rank14]:            ^^^^^^
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
14: [rank14]:     lambda: hydra.run(
14: [rank14]:             ^^^^^^^^^^
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
14: [rank14]:     _ = ret.return_value
14: [rank14]:         ^^^^^^^^^^^^^^^^
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
14: [rank14]:     raise self._return_value
14: [rank14]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
14: [rank14]:     ret.return_value = task_function(task_cfg)
14: [rank14]:                        ^^^^^^^^^^^^^^^^^^^^^^^
14: [rank14]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
14: [rank14]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
14: [rank14]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
14: [rank14]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
14: [rank14]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
14: [rank14]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
14: [rank14]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
14: [rank14]:     raise ValueError("Imaginary component {}".format(m))
14: [rank14]: ValueError: Imaginary component 0.0029952042492374167
50: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
50: [rank50]: Traceback (most recent call last):
50: [rank50]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
50: [rank50]:     main()
50: [rank50]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
50: [rank50]:     _run_hydra(
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
50: [rank50]:     _run_app(
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
50: [rank50]:     run_and_report(
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
50: [rank50]:     raise ex
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
50: [rank50]:     return func()
50: [rank50]:            ^^^^^^
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
50: [rank50]:     lambda: hydra.run(
50: [rank50]:             ^^^^^^^^^^
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
50: [rank50]:     _ = ret.return_value
50: [rank50]:         ^^^^^^^^^^^^^^^^
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
50: [rank50]:     raise self._return_value
50: [rank50]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
50: [rank50]:     ret.return_value = task_function(task_cfg)
50: [rank50]:                        ^^^^^^^^^^^^^^^^^^^^^^^
50: [rank50]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
50: [rank50]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
50: [rank50]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
50: [rank50]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
50: [rank50]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
50: [rank50]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
50: [rank50]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
50: [rank50]:     raise ValueError("Imaginary component {}".format(m))
50: [rank50]: ValueError: Imaginary component 0.0029952042492374167
 6: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
25: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 6: [rank6]: Traceback (most recent call last):
 6: [rank6]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 6: [rank6]:     main()
 6: [rank6]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 6: [rank6]:     _run_hydra(
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 6: [rank6]:     _run_app(
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 6: [rank6]:     run_and_report(
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 6: [rank6]:     raise ex
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 6: [rank6]:     return func()
 6: [rank6]:            ^^^^^^
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 6: [rank6]:     lambda: hydra.run(
 6: [rank6]:             ^^^^^^^^^^
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 6: [rank6]:     _ = ret.return_value
 6: [rank6]:         ^^^^^^^^^^^^^^^^
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 6: [rank6]:     raise self._return_value
 6: [rank6]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 6: [rank6]:     ret.return_value = task_function(task_cfg)
 6: [rank6]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 6: [rank6]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 6: [rank6]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 6: [rank6]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 6: [rank6]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 6: [rank6]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 6: [rank6]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 6: [rank6]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 6: [rank6]:     raise ValueError("Imaginary component {}".format(m))
 6: [rank6]: ValueError: Imaginary component 0.0029952042492374167
25: [rank25]: Traceback (most recent call last):
25: [rank25]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
25: [rank25]:     main()
25: [rank25]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
25: [rank25]:     _run_hydra(
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
25: [rank25]:     _run_app(
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
25: [rank25]:     run_and_report(
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
25: [rank25]:     raise ex
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
25: [rank25]:     return func()
25: [rank25]:            ^^^^^^
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
25: [rank25]:     lambda: hydra.run(
25: [rank25]:             ^^^^^^^^^^
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
25: [rank25]:     _ = ret.return_value
25: [rank25]:         ^^^^^^^^^^^^^^^^
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
25: [rank25]:     raise self._return_value
25: [rank25]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
25: [rank25]:     ret.return_value = task_function(task_cfg)
25: [rank25]:                        ^^^^^^^^^^^^^^^^^^^^^^^
25: [rank25]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
25: [rank25]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
25: [rank25]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25: [rank25]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
25: [rank25]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
25: [rank25]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25: [rank25]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
25: [rank25]:     raise ValueError("Imaginary component {}".format(m))
25: [rank25]: ValueError: Imaginary component 0.0029952042492374167
55: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
55: [rank55]: Traceback (most recent call last):
55: [rank55]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
55: [rank55]:     main()
55: [rank55]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
55: [rank55]:     _run_hydra(
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
55: [rank55]:     _run_app(
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
55: [rank55]:     run_and_report(
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
55: [rank55]:     raise ex
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
55: [rank55]:     return func()
55: [rank55]:            ^^^^^^
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
55: [rank55]:     lambda: hydra.run(
55: [rank55]:             ^^^^^^^^^^
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
55: [rank55]:     _ = ret.return_value
55: [rank55]:         ^^^^^^^^^^^^^^^^
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
55: [rank55]:     raise self._return_value
55: [rank55]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
55: [rank55]:     ret.return_value = task_function(task_cfg)
55: [rank55]:                        ^^^^^^^^^^^^^^^^^^^^^^^
55: [rank55]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
55: [rank55]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
55: [rank55]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
55: [rank55]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
55: [rank55]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
55: [rank55]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
55: [rank55]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
55: [rank55]:     raise ValueError("Imaginary component {}".format(m))
55: [rank55]: ValueError: Imaginary component 0.0029952042492374167
44: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
44: [rank44]: Traceback (most recent call last):
44: [rank44]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
44: [rank44]:     main()
44: [rank44]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
44: [rank44]:     _run_hydra(
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
44: [rank44]:     _run_app(
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
44: [rank44]:     run_and_report(
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
44: [rank44]:     raise ex
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
44: [rank44]:     return func()
44: [rank44]:            ^^^^^^
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
44: [rank44]:     lambda: hydra.run(
44: [rank44]:             ^^^^^^^^^^
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
44: [rank44]:     _ = ret.return_value
44: [rank44]:         ^^^^^^^^^^^^^^^^
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
44: [rank44]:     raise self._return_value
44: [rank44]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
44: [rank44]:     ret.return_value = task_function(task_cfg)
44: [rank44]:                        ^^^^^^^^^^^^^^^^^^^^^^^
44: [rank44]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
44: [rank44]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
44: [rank44]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
44: [rank44]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
44: [rank44]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
44: [rank44]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
44: [rank44]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
44: [rank44]:     raise ValueError("Imaginary component {}".format(m))
44: [rank44]: ValueError: Imaginary component 0.0029952042492374167
19: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
19: [rank19]: Traceback (most recent call last):
19: [rank19]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
19: [rank19]:     main()
19: [rank19]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
19: [rank19]:     _run_hydra(
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
19: [rank19]:     _run_app(
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
19: [rank19]:     run_and_report(
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
19: [rank19]:     raise ex
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
19: [rank19]:     return func()
19: [rank19]:            ^^^^^^
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
19: [rank19]:     lambda: hydra.run(
19: [rank19]:             ^^^^^^^^^^
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
19: [rank19]:     _ = ret.return_value
19: [rank19]:         ^^^^^^^^^^^^^^^^
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
19: [rank19]:     raise self._return_value
19: [rank19]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
19: [rank19]:     ret.return_value = task_function(task_cfg)
19: [rank19]:                        ^^^^^^^^^^^^^^^^^^^^^^^
19: [rank19]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
19: [rank19]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
19: [rank19]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19: [rank19]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
19: [rank19]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
19: [rank19]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19: [rank19]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
19: [rank19]:     raise ValueError("Imaginary component {}".format(m))
19: [rank19]: ValueError: Imaginary component 0.0029952042492374167
23: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
23: [rank23]: Traceback (most recent call last):
23: [rank23]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
23: [rank23]:     main()
23: [rank23]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
23: [rank23]:     _run_hydra(
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
23: [rank23]:     _run_app(
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
23: [rank23]:     run_and_report(
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
23: [rank23]:     raise ex
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
23: [rank23]:     return func()
23: [rank23]:            ^^^^^^
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
23: [rank23]:     lambda: hydra.run(
23: [rank23]:             ^^^^^^^^^^
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
23: [rank23]:     _ = ret.return_value
23: [rank23]:         ^^^^^^^^^^^^^^^^
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
23: [rank23]:     raise self._return_value
23: [rank23]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
23: [rank23]:     ret.return_value = task_function(task_cfg)
23: [rank23]:                        ^^^^^^^^^^^^^^^^^^^^^^^
23: [rank23]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
23: [rank23]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
23: [rank23]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23: [rank23]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
23: [rank23]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
23: [rank23]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23: [rank23]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
23: [rank23]:     raise ValueError("Imaginary component {}".format(m))
23: [rank23]: ValueError: Imaginary component 0.0029952042492374167
12: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
12: [rank12]: Traceback (most recent call last):
12: [rank12]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
12: [rank12]:     main()
12: [rank12]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
12: [rank12]:     _run_hydra(
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
12: [rank12]:     _run_app(
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
12: [rank12]:     run_and_report(
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
12: [rank12]:     raise ex
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
12: [rank12]:     return func()
12: [rank12]:            ^^^^^^
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
12: [rank12]:     lambda: hydra.run(
12: [rank12]:             ^^^^^^^^^^
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
12: [rank12]:     _ = ret.return_value
12: [rank12]:         ^^^^^^^^^^^^^^^^
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
12: [rank12]:     raise self._return_value
12: [rank12]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
12: [rank12]:     ret.return_value = task_function(task_cfg)
12: [rank12]:                        ^^^^^^^^^^^^^^^^^^^^^^^
12: [rank12]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
12: [rank12]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
12: [rank12]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12: [rank12]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
12: [rank12]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
12: [rank12]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12: [rank12]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
12: [rank12]:     raise ValueError("Imaginary component {}".format(m))
12: [rank12]: ValueError: Imaginary component 0.0029952042492374167
58: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
58: [rank58]: Traceback (most recent call last):
58: [rank58]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
58: [rank58]:     main()
58: [rank58]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
58: [rank58]:     _run_hydra(
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
58: [rank58]:     _run_app(
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
58: [rank58]:     run_and_report(
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
58: [rank58]:     raise ex
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
58: [rank58]:     return func()
58: [rank58]:            ^^^^^^
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
58: [rank58]:     lambda: hydra.run(
58: [rank58]:             ^^^^^^^^^^
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
58: [rank58]:     _ = ret.return_value
58: [rank58]:         ^^^^^^^^^^^^^^^^
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
58: [rank58]:     raise self._return_value
58: [rank58]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
58: [rank58]:     ret.return_value = task_function(task_cfg)
58: [rank58]:                        ^^^^^^^^^^^^^^^^^^^^^^^
58: [rank58]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
58: [rank58]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
58: [rank58]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
58: [rank58]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
58: [rank58]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
58: [rank58]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
58: [rank58]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
58: [rank58]:     raise ValueError("Imaginary component {}".format(m))
58: [rank58]: ValueError: Imaginary component 0.0029952042492374167
62: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
62: [rank62]: Traceback (most recent call last):
62: [rank62]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
62: [rank62]:     main()
62: [rank62]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
62: [rank62]:     _run_hydra(
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
62: [rank62]:     _run_app(
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
62: [rank62]:     run_and_report(
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
62: [rank62]:     raise ex
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
62: [rank62]:     return func()
62: [rank62]:            ^^^^^^
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
62: [rank62]:     lambda: hydra.run(
62: [rank62]:             ^^^^^^^^^^
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
62: [rank62]:     _ = ret.return_value
62: [rank62]:         ^^^^^^^^^^^^^^^^
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
62: [rank62]:     raise self._return_value
62: [rank62]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
62: [rank62]:     ret.return_value = task_function(task_cfg)
62: [rank62]:                        ^^^^^^^^^^^^^^^^^^^^^^^
62: [rank62]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
62: [rank62]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
62: [rank62]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
62: [rank62]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
62: [rank62]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
62: [rank62]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
62: [rank62]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
62: [rank62]:     raise ValueError("Imaginary component {}".format(m))
62: [rank62]: ValueError: Imaginary component 0.0029952042492374167
 3: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
54: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 3: [rank3]: Traceback (most recent call last):
 3: [rank3]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 3: [rank3]:     main()
 3: [rank3]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 3: [rank3]:     _run_hydra(
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 3: [rank3]:     _run_app(
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 3: [rank3]:     run_and_report(
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 3: [rank3]:     raise ex
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 3: [rank3]:     return func()
 3: [rank3]:            ^^^^^^
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 3: [rank3]:     lambda: hydra.run(
 3: [rank3]:             ^^^^^^^^^^
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 3: [rank3]:     _ = ret.return_value
 3: [rank3]:         ^^^^^^^^^^^^^^^^
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 3: [rank3]:     raise self._return_value
 3: [rank3]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 3: [rank3]:     ret.return_value = task_function(task_cfg)
 3: [rank3]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 3: [rank3]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 3: [rank3]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 3: [rank3]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 3: [rank3]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 3: [rank3]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 3: [rank3]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 3: [rank3]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 3: [rank3]:     raise ValueError("Imaginary component {}".format(m))
 3: [rank3]: ValueError: Imaginary component 0.0029952042492374167
54: [rank54]: Traceback (most recent call last):
54: [rank54]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
54: [rank54]:     main()
54: [rank54]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
54: [rank54]:     _run_hydra(
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
54: [rank54]:     _run_app(
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
54: [rank54]:     run_and_report(
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
54: [rank54]:     raise ex
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
54: [rank54]:     return func()
54: [rank54]:            ^^^^^^
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
54: [rank54]:     lambda: hydra.run(
54: [rank54]:             ^^^^^^^^^^
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
54: [rank54]:     _ = ret.return_value
54: [rank54]:         ^^^^^^^^^^^^^^^^
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
54: [rank54]:     raise self._return_value
54: [rank54]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
54: [rank54]:     ret.return_value = task_function(task_cfg)
54: [rank54]:                        ^^^^^^^^^^^^^^^^^^^^^^^
54: [rank54]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
54: [rank54]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
54: [rank54]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
54: [rank54]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
54: [rank54]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
54: [rank54]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
54: [rank54]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
54: [rank54]:     raise ValueError("Imaginary component {}".format(m))
54: [rank54]: ValueError: Imaginary component 0.0029952042492374167
57: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
57: [rank57]: Traceback (most recent call last):
57: [rank57]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
57: [rank57]:     main()
57: [rank57]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
57: [rank57]:     _run_hydra(
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
57: [rank57]:     _run_app(
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
57: [rank57]:     run_and_report(
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
57: [rank57]:     raise ex
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
57: [rank57]:     return func()
57: [rank57]:            ^^^^^^
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
57: [rank57]:     lambda: hydra.run(
57: [rank57]:             ^^^^^^^^^^
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
57: [rank57]:     _ = ret.return_value
57: [rank57]:         ^^^^^^^^^^^^^^^^
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
57: [rank57]:     raise self._return_value
57: [rank57]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
57: [rank57]:     ret.return_value = task_function(task_cfg)
57: [rank57]:                        ^^^^^^^^^^^^^^^^^^^^^^^
57: [rank57]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
57: [rank57]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
57: [rank57]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
57: [rank57]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
57: [rank57]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
57: [rank57]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
57: [rank57]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
57: [rank57]:     raise ValueError("Imaginary component {}".format(m))
57: [rank57]: ValueError: Imaginary component 0.0029952042492374167
39: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
39: [rank39]: Traceback (most recent call last):
39: [rank39]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
39: [rank39]:     main()
39: [rank39]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
39: [rank39]:     _run_hydra(
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
39: [rank39]:     _run_app(
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
39: [rank39]:     run_and_report(
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
39: [rank39]:     raise ex
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
39: [rank39]:     return func()
39: [rank39]:            ^^^^^^
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
39: [rank39]:     lambda: hydra.run(
39: [rank39]:             ^^^^^^^^^^
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
39: [rank39]:     _ = ret.return_value
39: [rank39]:         ^^^^^^^^^^^^^^^^
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
39: [rank39]:     raise self._return_value
39: [rank39]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
39: [rank39]:     ret.return_value = task_function(task_cfg)
39: [rank39]:                        ^^^^^^^^^^^^^^^^^^^^^^^
39: [rank39]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
39: [rank39]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
39: [rank39]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
39: [rank39]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
39: [rank39]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
39: [rank39]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
39: [rank39]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
39: [rank39]:     raise ValueError("Imaginary component {}".format(m))
39: [rank39]: ValueError: Imaginary component 0.0029952042492374167
24: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
24: [rank24]: Traceback (most recent call last):
24: [rank24]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
24: [rank24]:     main()
24: [rank24]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
24: [rank24]:     _run_hydra(
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
24: [rank24]:     _run_app(
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
24: [rank24]:     run_and_report(
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
24: [rank24]:     raise ex
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
24: [rank24]:     return func()
24: [rank24]:            ^^^^^^
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
24: [rank24]:     lambda: hydra.run(
24: [rank24]:             ^^^^^^^^^^
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
24: [rank24]:     _ = ret.return_value
24: [rank24]:         ^^^^^^^^^^^^^^^^
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
24: [rank24]:     raise self._return_value
24: [rank24]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
24: [rank24]:     ret.return_value = task_function(task_cfg)
24: [rank24]:                        ^^^^^^^^^^^^^^^^^^^^^^^
24: [rank24]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
24: [rank24]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
24: [rank24]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24: [rank24]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
24: [rank24]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
24: [rank24]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24: [rank24]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
24: [rank24]:     raise ValueError("Imaginary component {}".format(m))
24: [rank24]: ValueError: Imaginary component 0.0029952042492374167
26: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
26: [rank26]: Traceback (most recent call last):
26: [rank26]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
26: [rank26]:     main()
26: [rank26]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
26: [rank26]:     _run_hydra(
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
26: [rank26]:     _run_app(
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
26: [rank26]:     run_and_report(
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
26: [rank26]:     raise ex
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
26: [rank26]:     return func()
26: [rank26]:            ^^^^^^
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
26: [rank26]:     lambda: hydra.run(
26: [rank26]:             ^^^^^^^^^^
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
26: [rank26]:     _ = ret.return_value
26: [rank26]:         ^^^^^^^^^^^^^^^^
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
26: [rank26]:     raise self._return_value
26: [rank26]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
26: [rank26]:     ret.return_value = task_function(task_cfg)
26: [rank26]:                        ^^^^^^^^^^^^^^^^^^^^^^^
26: [rank26]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
26: [rank26]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
26: [rank26]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
26: [rank26]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
26: [rank26]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
26: [rank26]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
26: [rank26]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
26: [rank26]:     raise ValueError("Imaginary component {}".format(m))
26: [rank26]: ValueError: Imaginary component 0.0029952042492374167
36: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
36: [rank36]: Traceback (most recent call last):
36: [rank36]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
36: [rank36]:     main()
36: [rank36]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
36: [rank36]:     _run_hydra(
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
36: [rank36]:     _run_app(
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
36: [rank36]:     run_and_report(
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
36: [rank36]:     raise ex
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
36: [rank36]:     return func()
36: [rank36]:            ^^^^^^
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
36: [rank36]:     lambda: hydra.run(
36: [rank36]:             ^^^^^^^^^^
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
36: [rank36]:     _ = ret.return_value
36: [rank36]:         ^^^^^^^^^^^^^^^^
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
36: [rank36]:     raise self._return_value
36: [rank36]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
36: [rank36]:     ret.return_value = task_function(task_cfg)
36: [rank36]:                        ^^^^^^^^^^^^^^^^^^^^^^^
36: [rank36]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
36: [rank36]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
36: [rank36]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
36: [rank36]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
36: [rank36]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
36: [rank36]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
36: [rank36]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
36: [rank36]:     raise ValueError("Imaginary component {}".format(m))
36: [rank36]: ValueError: Imaginary component 0.0029952042492374167
45: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
45: [rank45]: Traceback (most recent call last):
45: [rank45]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
45: [rank45]:     main()
45: [rank45]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
45: [rank45]:     _run_hydra(
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
45: [rank45]:     _run_app(
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
45: [rank45]:     run_and_report(
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
45: [rank45]:     raise ex
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
45: [rank45]:     return func()
45: [rank45]:            ^^^^^^
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
45: [rank45]:     lambda: hydra.run(
45: [rank45]:             ^^^^^^^^^^
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
45: [rank45]:     _ = ret.return_value
45: [rank45]:         ^^^^^^^^^^^^^^^^
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
45: [rank45]:     raise self._return_value
45: [rank45]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
45: [rank45]:     ret.return_value = task_function(task_cfg)
45: [rank45]:                        ^^^^^^^^^^^^^^^^^^^^^^^
45: [rank45]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
45: [rank45]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
45: [rank45]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
45: [rank45]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
45: [rank45]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
45: [rank45]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
45: [rank45]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
45: [rank45]:     raise ValueError("Imaginary component {}".format(m))
45: [rank45]: ValueError: Imaginary component 0.0029952042492374167
56: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
56: [rank56]: Traceback (most recent call last):
56: [rank56]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
56: [rank56]:     main()
56: [rank56]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
56: [rank56]:     _run_hydra(
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
56: [rank56]:     _run_app(
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
56: [rank56]:     run_and_report(
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
56: [rank56]:     raise ex
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
56: [rank56]:     return func()
56: [rank56]:            ^^^^^^
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
56: [rank56]:     lambda: hydra.run(
56: [rank56]:             ^^^^^^^^^^
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
56: [rank56]:     _ = ret.return_value
56: [rank56]:         ^^^^^^^^^^^^^^^^
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
56: [rank56]:     raise self._return_value
56: [rank56]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
56: [rank56]:     ret.return_value = task_function(task_cfg)
56: [rank56]:                        ^^^^^^^^^^^^^^^^^^^^^^^
56: [rank56]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
56: [rank56]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
56: [rank56]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
56: [rank56]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
56: [rank56]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
56: [rank56]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
56: [rank56]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
56: [rank56]:     raise ValueError("Imaginary component {}".format(m))
56: [rank56]: ValueError: Imaginary component 0.0029952042492374167
46: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
46: [rank46]: Traceback (most recent call last):
46: [rank46]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
46: [rank46]:     main()
46: [rank46]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
46: [rank46]:     _run_hydra(
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
46: [rank46]:     _run_app(
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
46: [rank46]:     run_and_report(
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
46: [rank46]:     raise ex
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
46: [rank46]:     return func()
46: [rank46]:            ^^^^^^
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
46: [rank46]:     lambda: hydra.run(
46: [rank46]:             ^^^^^^^^^^
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
46: [rank46]:     _ = ret.return_value
46: [rank46]:         ^^^^^^^^^^^^^^^^
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
46: [rank46]:     raise self._return_value
46: [rank46]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
46: [rank46]:     ret.return_value = task_function(task_cfg)
46: [rank46]:                        ^^^^^^^^^^^^^^^^^^^^^^^
46: [rank46]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
46: [rank46]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
46: [rank46]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46: [rank46]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
46: [rank46]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
46: [rank46]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46: [rank46]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
46: [rank46]:     raise ValueError("Imaginary component {}".format(m))
46: [rank46]: ValueError: Imaginary component 0.0029952042492374167
27: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
27: [rank27]: Traceback (most recent call last):
27: [rank27]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
27: [rank27]:     main()
27: [rank27]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
27: [rank27]:     _run_hydra(
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
27: [rank27]:     _run_app(
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
27: [rank27]:     run_and_report(
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
27: [rank27]:     raise ex
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
27: [rank27]:     return func()
27: [rank27]:            ^^^^^^
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
27: [rank27]:     lambda: hydra.run(
27: [rank27]:             ^^^^^^^^^^
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
27: [rank27]:     _ = ret.return_value
27: [rank27]:         ^^^^^^^^^^^^^^^^
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
27: [rank27]:     raise self._return_value
27: [rank27]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
27: [rank27]:     ret.return_value = task_function(task_cfg)
27: [rank27]:                        ^^^^^^^^^^^^^^^^^^^^^^^
27: [rank27]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
27: [rank27]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
27: [rank27]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
27: [rank27]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
27: [rank27]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
27: [rank27]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
27: [rank27]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
27: [rank27]:     raise ValueError("Imaginary component {}".format(m))
27: [rank27]: ValueError: Imaginary component 0.0029952042492374167
42: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
47: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
42: [rank42]: Traceback (most recent call last):
42: [rank42]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
42: [rank42]:     main()
42: [rank42]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
42: [rank42]:     _run_hydra(
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
42: [rank42]:     _run_app(
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
42: [rank42]:     run_and_report(
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
42: [rank42]:     raise ex
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
42: [rank42]:     return func()
42: [rank42]:            ^^^^^^
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
42: [rank42]:     lambda: hydra.run(
42: [rank42]:             ^^^^^^^^^^
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
42: [rank42]:     _ = ret.return_value
42: [rank42]:         ^^^^^^^^^^^^^^^^
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
42: [rank42]:     raise self._return_value
42: [rank42]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
42: [rank42]:     ret.return_value = task_function(task_cfg)
42: [rank42]:                        ^^^^^^^^^^^^^^^^^^^^^^^
42: [rank42]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
42: [rank42]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
42: [rank42]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
42: [rank42]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
42: [rank42]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
42: [rank42]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
42: [rank42]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
42: [rank42]:     raise ValueError("Imaginary component {}".format(m))
42: [rank42]: ValueError: Imaginary component 0.0029952042492374167
47: [rank47]: Traceback (most recent call last):
47: [rank47]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
47: [rank47]:     main()
47: [rank47]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
47: [rank47]:     _run_hydra(
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
47: [rank47]:     _run_app(
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
47: [rank47]:     run_and_report(
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
47: [rank47]:     raise ex
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
47: [rank47]:     return func()
47: [rank47]:            ^^^^^^
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
47: [rank47]:     lambda: hydra.run(
47: [rank47]:             ^^^^^^^^^^
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
47: [rank47]:     _ = ret.return_value
47: [rank47]:         ^^^^^^^^^^^^^^^^
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
47: [rank47]:     raise self._return_value
47: [rank47]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
47: [rank47]:     ret.return_value = task_function(task_cfg)
47: [rank47]:                        ^^^^^^^^^^^^^^^^^^^^^^^
47: [rank47]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
47: [rank47]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
47: [rank47]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
47: [rank47]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
47: [rank47]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
47: [rank47]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
47: [rank47]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
47: [rank47]:     raise ValueError("Imaginary component {}".format(m))
47: [rank47]: ValueError: Imaginary component 0.0029952042492374167
51: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
51: [rank51]: Traceback (most recent call last):
51: [rank51]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
51: [rank51]:     main()
51: [rank51]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
51: [rank51]:     _run_hydra(
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
51: [rank51]:     _run_app(
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
51: [rank51]:     run_and_report(
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
51: [rank51]:     raise ex
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
51: [rank51]:     return func()
51: [rank51]:            ^^^^^^
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
51: [rank51]:     lambda: hydra.run(
51: [rank51]:             ^^^^^^^^^^
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
51: [rank51]:     _ = ret.return_value
51: [rank51]:         ^^^^^^^^^^^^^^^^
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
51: [rank51]:     raise self._return_value
51: [rank51]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
51: [rank51]:     ret.return_value = task_function(task_cfg)
51: [rank51]:                        ^^^^^^^^^^^^^^^^^^^^^^^
51: [rank51]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
51: [rank51]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
51: [rank51]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
51: [rank51]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
51: [rank51]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
51: [rank51]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
51: [rank51]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
51: [rank51]:     raise ValueError("Imaginary component {}".format(m))
51: [rank51]: ValueError: Imaginary component 0.0029952042492374167
53: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
53: [rank53]: Traceback (most recent call last):
53: [rank53]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
53: [rank53]:     main()
53: [rank53]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
53: [rank53]:     _run_hydra(
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
53: [rank53]:     _run_app(
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
53: [rank53]:     run_and_report(
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
53: [rank53]:     raise ex
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
53: [rank53]:     return func()
53: [rank53]:            ^^^^^^
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
53: [rank53]:     lambda: hydra.run(
53: [rank53]:             ^^^^^^^^^^
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
53: [rank53]:     _ = ret.return_value
53: [rank53]:         ^^^^^^^^^^^^^^^^
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
53: [rank53]:     raise self._return_value
53: [rank53]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
53: [rank53]:     ret.return_value = task_function(task_cfg)
53: [rank53]:                        ^^^^^^^^^^^^^^^^^^^^^^^
53: [rank53]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
53: [rank53]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
53: [rank53]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
53: [rank53]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
53: [rank53]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
53: [rank53]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
53: [rank53]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
53: [rank53]:     raise ValueError("Imaginary component {}".format(m))
53: [rank53]: ValueError: Imaginary component 0.0029952042492374167
61: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
61: [rank61]: Traceback (most recent call last):
61: [rank61]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
61: [rank61]:     main()
61: [rank61]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
61: [rank61]:     _run_hydra(
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
61: [rank61]:     _run_app(
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
61: [rank61]:     run_and_report(
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
61: [rank61]:     raise ex
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
61: [rank61]:     return func()
61: [rank61]:            ^^^^^^
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
61: [rank61]:     lambda: hydra.run(
61: [rank61]:             ^^^^^^^^^^
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
61: [rank61]:     _ = ret.return_value
61: [rank61]:         ^^^^^^^^^^^^^^^^
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
61: [rank61]:     raise self._return_value
61: [rank61]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
61: [rank61]:     ret.return_value = task_function(task_cfg)
61: [rank61]:                        ^^^^^^^^^^^^^^^^^^^^^^^
61: [rank61]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
61: [rank61]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
61: [rank61]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
61: [rank61]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
61: [rank61]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
61: [rank61]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
61: [rank61]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
61: [rank61]:     raise ValueError("Imaginary component {}".format(m))
61: [rank61]: ValueError: Imaginary component 0.0029952042492374167
17: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
17: [rank17]: Traceback (most recent call last):
17: [rank17]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
17: [rank17]:     main()
17: [rank17]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
17: [rank17]:     _run_hydra(
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
17: [rank17]:     _run_app(
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
17: [rank17]:     run_and_report(
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
17: [rank17]:     raise ex
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
17: [rank17]:     return func()
17: [rank17]:            ^^^^^^
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
17: [rank17]:     lambda: hydra.run(
17: [rank17]:             ^^^^^^^^^^
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
17: [rank17]:     _ = ret.return_value
17: [rank17]:         ^^^^^^^^^^^^^^^^
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
17: [rank17]:     raise self._return_value
17: [rank17]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
17: [rank17]:     ret.return_value = task_function(task_cfg)
17: [rank17]:                        ^^^^^^^^^^^^^^^^^^^^^^^
17: [rank17]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
17: [rank17]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
17: [rank17]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17: [rank17]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
17: [rank17]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
17: [rank17]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17: [rank17]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
17: [rank17]:     raise ValueError("Imaginary component {}".format(m))
17: [rank17]: ValueError: Imaginary component 0.0029952042492374167
 4: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 4: [rank4]: Traceback (most recent call last):
 4: [rank4]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 4: [rank4]:     main()
 4: [rank4]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 4: [rank4]:     _run_hydra(
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 4: [rank4]:     _run_app(
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 4: [rank4]:     run_and_report(
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 4: [rank4]:     raise ex
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 4: [rank4]:     return func()
 4: [rank4]:            ^^^^^^
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 4: [rank4]:     lambda: hydra.run(
 4: [rank4]:             ^^^^^^^^^^
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 4: [rank4]:     _ = ret.return_value
 4: [rank4]:         ^^^^^^^^^^^^^^^^
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 4: [rank4]:     raise self._return_value
 4: [rank4]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 4: [rank4]:     ret.return_value = task_function(task_cfg)
 4: [rank4]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 4: [rank4]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 4: [rank4]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 4: [rank4]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 4: [rank4]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 4: [rank4]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 4: [rank4]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 4: [rank4]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 4: [rank4]:     raise ValueError("Imaginary component {}".format(m))
 4: [rank4]: ValueError: Imaginary component 0.0029952042492374167
 9: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 9: [rank9]: Traceback (most recent call last):
 9: [rank9]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 9: [rank9]:     main()
 9: [rank9]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 9: [rank9]:     _run_hydra(
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 9: [rank9]:     _run_app(
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 9: [rank9]:     run_and_report(
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 9: [rank9]:     raise ex
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 9: [rank9]:     return func()
 9: [rank9]:            ^^^^^^
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 9: [rank9]:     lambda: hydra.run(
 9: [rank9]:             ^^^^^^^^^^
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 9: [rank9]:     _ = ret.return_value
 9: [rank9]:         ^^^^^^^^^^^^^^^^
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 9: [rank9]:     raise self._return_value
 9: [rank9]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 9: [rank9]:     ret.return_value = task_function(task_cfg)
 9: [rank9]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 9: [rank9]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 9: [rank9]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 9: [rank9]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9: [rank9]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 9: [rank9]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 9: [rank9]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9: [rank9]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 9: [rank9]:     raise ValueError("Imaginary component {}".format(m))
 9: [rank9]: ValueError: Imaginary component 0.0029952042492374167
 0: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 0: [rank0]: Traceback (most recent call last):
 0: [rank0]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 0: [rank0]:     main()
 0: [rank0]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 0: [rank0]:     _run_hydra(
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 0: [rank0]:     _run_app(
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 0: [rank0]:     run_and_report(
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 0: [rank0]:     raise ex
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 0: [rank0]:     return func()
 0: [rank0]:            ^^^^^^
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 0: [rank0]:     lambda: hydra.run(
 0: [rank0]:             ^^^^^^^^^^
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 0: [rank0]:     _ = ret.return_value
 0: [rank0]:         ^^^^^^^^^^^^^^^^
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 0: [rank0]:     raise self._return_value
 0: [rank0]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 0: [rank0]:     ret.return_value = task_function(task_cfg)
 0: [rank0]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 0: [rank0]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 0: [rank0]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 0: [rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 0: [rank0]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 0: [rank0]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 0: [rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 0: [rank0]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 0: [rank0]:     raise ValueError("Imaginary component {}".format(m))
 0: [rank0]: ValueError: Imaginary component 0.0029952042492374167
30: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
30: [rank30]: Traceback (most recent call last):
30: [rank30]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
30: [rank30]:     main()
30: [rank30]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
30: [rank30]:     _run_hydra(
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
30: [rank30]:     _run_app(
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
30: [rank30]:     run_and_report(
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
30: [rank30]:     raise ex
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
30: [rank30]:     return func()
30: [rank30]:            ^^^^^^
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
30: [rank30]:     lambda: hydra.run(
30: [rank30]:             ^^^^^^^^^^
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
30: [rank30]:     _ = ret.return_value
30: [rank30]:         ^^^^^^^^^^^^^^^^
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
30: [rank30]:     raise self._return_value
30: [rank30]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
30: [rank30]:     ret.return_value = task_function(task_cfg)
30: [rank30]:                        ^^^^^^^^^^^^^^^^^^^^^^^
30: [rank30]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
30: [rank30]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
30: [rank30]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30: [rank30]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
30: [rank30]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
30: [rank30]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30: [rank30]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
30: [rank30]:     raise ValueError("Imaginary component {}".format(m))
30: [rank30]: ValueError: Imaginary component 0.0029952042492374167
 7: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 7: [rank7]: Traceback (most recent call last):
 7: [rank7]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 7: [rank7]:     main()
 7: [rank7]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 7: [rank7]:     _run_hydra(
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 7: [rank7]:     _run_app(
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 7: [rank7]:     run_and_report(
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 7: [rank7]:     raise ex
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 7: [rank7]:     return func()
 7: [rank7]:            ^^^^^^
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 7: [rank7]:     lambda: hydra.run(
 7: [rank7]:             ^^^^^^^^^^
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 7: [rank7]:     _ = ret.return_value
 7: [rank7]:         ^^^^^^^^^^^^^^^^
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 7: [rank7]:     raise self._return_value
 7: [rank7]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 7: [rank7]:     ret.return_value = task_function(task_cfg)
 7: [rank7]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 7: [rank7]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 7: [rank7]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 7: [rank7]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 7: [rank7]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 7: [rank7]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 7: [rank7]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 7: [rank7]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 7: [rank7]:     raise ValueError("Imaginary component {}".format(m))
 7: [rank7]: ValueError: Imaginary component 0.0029952042492374167
33: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
38: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
33: [rank33]: Traceback (most recent call last):
33: [rank33]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
33: [rank33]:     main()
33: [rank33]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
33: [rank33]:     _run_hydra(
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
33: [rank33]:     _run_app(
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
33: [rank33]:     run_and_report(
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
33: [rank33]:     raise ex
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
33: [rank33]:     return func()
33: [rank33]:            ^^^^^^
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
33: [rank33]:     lambda: hydra.run(
33: [rank33]:             ^^^^^^^^^^
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
33: [rank33]:     _ = ret.return_value
33: [rank33]:         ^^^^^^^^^^^^^^^^
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
33: [rank33]:     raise self._return_value
33: [rank33]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
33: [rank33]:     ret.return_value = task_function(task_cfg)
33: [rank33]:                        ^^^^^^^^^^^^^^^^^^^^^^^
33: [rank33]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
33: [rank33]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
33: [rank33]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33: [rank33]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
33: [rank33]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
33: [rank33]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33: [rank33]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
33: [rank33]:     raise ValueError("Imaginary component {}".format(m))
33: [rank33]: ValueError: Imaginary component 0.0029952042492374167
38: [rank38]: Traceback (most recent call last):
38: [rank38]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
38: [rank38]:     main()
38: [rank38]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
38: [rank38]:     _run_hydra(
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
38: [rank38]:     _run_app(
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
38: [rank38]:     run_and_report(
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
38: [rank38]:     raise ex
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
38: [rank38]:     return func()
38: [rank38]:            ^^^^^^
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
38: [rank38]:     lambda: hydra.run(
38: [rank38]:             ^^^^^^^^^^
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
38: [rank38]:     _ = ret.return_value
38: [rank38]:         ^^^^^^^^^^^^^^^^
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
38: [rank38]:     raise self._return_value
38: [rank38]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
38: [rank38]:     ret.return_value = task_function(task_cfg)
38: [rank38]:                        ^^^^^^^^^^^^^^^^^^^^^^^
38: [rank38]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
38: [rank38]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
38: [rank38]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
38: [rank38]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
38: [rank38]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
38: [rank38]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
38: [rank38]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
38: [rank38]:     raise ValueError("Imaginary component {}".format(m))
38: [rank38]: ValueError: Imaginary component 0.0029952042492374167
29: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
18: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
29: [rank29]: Traceback (most recent call last):
29: [rank29]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
29: [rank29]:     main()
29: [rank29]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
29: [rank29]:     _run_hydra(
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
29: [rank29]:     _run_app(
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
29: [rank29]:     run_and_report(
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
29: [rank29]:     raise ex
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
29: [rank29]:     return func()
29: [rank29]:            ^^^^^^
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
29: [rank29]:     lambda: hydra.run(
29: [rank29]:             ^^^^^^^^^^
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
29: [rank29]:     _ = ret.return_value
29: [rank29]:         ^^^^^^^^^^^^^^^^
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
29: [rank29]:     raise self._return_value
29: [rank29]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
29: [rank29]:     ret.return_value = task_function(task_cfg)
29: [rank29]:                        ^^^^^^^^^^^^^^^^^^^^^^^
29: [rank29]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
29: [rank29]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
29: [rank29]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29: [rank29]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
29: [rank29]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
29: [rank29]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29: [rank29]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
29: [rank29]:     raise ValueError("Imaginary component {}".format(m))
29: [rank29]: ValueError: Imaginary component 0.0029952042492374167
18: [rank18]: Traceback (most recent call last):
18: [rank18]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
18: [rank18]:     main()
18: [rank18]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
18: [rank18]:     _run_hydra(
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
18: [rank18]:     _run_app(
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
18: [rank18]:     run_and_report(
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
18: [rank18]:     raise ex
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
18: [rank18]:     return func()
18: [rank18]:            ^^^^^^
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
18: [rank18]:     lambda: hydra.run(
18: [rank18]:             ^^^^^^^^^^
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
18: [rank18]:     _ = ret.return_value
18: [rank18]:         ^^^^^^^^^^^^^^^^
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
18: [rank18]:     raise self._return_value
18: [rank18]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
18: [rank18]:     ret.return_value = task_function(task_cfg)
18: [rank18]:                        ^^^^^^^^^^^^^^^^^^^^^^^
18: [rank18]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
18: [rank18]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
18: [rank18]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18: [rank18]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
18: [rank18]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
18: [rank18]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18: [rank18]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
18: [rank18]:     raise ValueError("Imaginary component {}".format(m))
18: [rank18]: ValueError: Imaginary component 0.0029952042492374167
 1: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
28: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 1: [rank1]: Traceback (most recent call last):
 1: [rank1]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 1: [rank1]:     main()
 1: [rank1]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 1: [rank1]:     _run_hydra(
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 1: [rank1]:     _run_app(
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 1: [rank1]:     run_and_report(
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 1: [rank1]:     raise ex
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 1: [rank1]:     return func()
 1: [rank1]:            ^^^^^^
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 1: [rank1]:     lambda: hydra.run(
 1: [rank1]:             ^^^^^^^^^^
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 1: [rank1]:     _ = ret.return_value
 1: [rank1]:         ^^^^^^^^^^^^^^^^
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 1: [rank1]:     raise self._return_value
 1: [rank1]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 1: [rank1]:     ret.return_value = task_function(task_cfg)
 1: [rank1]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 1: [rank1]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 1: [rank1]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 1: [rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 1: [rank1]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 1: [rank1]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 1: [rank1]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 1: [rank1]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 1: [rank1]:     raise ValueError("Imaginary component {}".format(m))
 1: [rank1]: ValueError: Imaginary component 0.0029952042492374167
28: [rank28]: Traceback (most recent call last):
28: [rank28]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
28: [rank28]:     main()
28: [rank28]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
28: [rank28]:     _run_hydra(
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
28: [rank28]:     _run_app(
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
28: [rank28]:     run_and_report(
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
28: [rank28]:     raise ex
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
28: [rank28]:     return func()
28: [rank28]:            ^^^^^^
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
28: [rank28]:     lambda: hydra.run(
28: [rank28]:             ^^^^^^^^^^
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
28: [rank28]:     _ = ret.return_value
28: [rank28]:         ^^^^^^^^^^^^^^^^
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
28: [rank28]:     raise self._return_value
28: [rank28]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
28: [rank28]:     ret.return_value = task_function(task_cfg)
28: [rank28]:                        ^^^^^^^^^^^^^^^^^^^^^^^
28: [rank28]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
28: [rank28]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
28: [rank28]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28: [rank28]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
28: [rank28]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
28: [rank28]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28: [rank28]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
28: [rank28]:     raise ValueError("Imaginary component {}".format(m))
28: [rank28]: ValueError: Imaginary component 0.0029952042492374167
49: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
49: [rank49]: Traceback (most recent call last):
49: [rank49]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
49: [rank49]:     main()
49: [rank49]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
49: [rank49]:     _run_hydra(
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
49: [rank49]:     _run_app(
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
49: [rank49]:     run_and_report(
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
49: [rank49]:     raise ex
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
49: [rank49]:     return func()
49: [rank49]:            ^^^^^^
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
49: [rank49]:     lambda: hydra.run(
49: [rank49]:             ^^^^^^^^^^
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
49: [rank49]:     _ = ret.return_value
49: [rank49]:         ^^^^^^^^^^^^^^^^
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
49: [rank49]:     raise self._return_value
49: [rank49]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
49: [rank49]:     ret.return_value = task_function(task_cfg)
49: [rank49]:                        ^^^^^^^^^^^^^^^^^^^^^^^
49: [rank49]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
49: [rank49]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
49: [rank49]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
49: [rank49]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
49: [rank49]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
49: [rank49]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
49: [rank49]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
49: [rank49]:     raise ValueError("Imaginary component {}".format(m))
49: [rank49]: ValueError: Imaginary component 0.0029952042492374167
43: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
43: [rank43]: Traceback (most recent call last):
43: [rank43]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
43: [rank43]:     main()
43: [rank43]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
43: [rank43]:     _run_hydra(
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
43: [rank43]:     _run_app(
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
43: [rank43]:     run_and_report(
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
43: [rank43]:     raise ex
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
43: [rank43]:     return func()
43: [rank43]:            ^^^^^^
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
43: [rank43]:     lambda: hydra.run(
43: [rank43]:             ^^^^^^^^^^
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
43: [rank43]:     _ = ret.return_value
43: [rank43]:         ^^^^^^^^^^^^^^^^
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
43: [rank43]:     raise self._return_value
43: [rank43]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
43: [rank43]:     ret.return_value = task_function(task_cfg)
43: [rank43]:                        ^^^^^^^^^^^^^^^^^^^^^^^
43: [rank43]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
43: [rank43]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
43: [rank43]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
43: [rank43]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
43: [rank43]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
43: [rank43]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
43: [rank43]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
43: [rank43]:     raise ValueError("Imaginary component {}".format(m))
43: [rank43]: ValueError: Imaginary component 0.0029952042492374167
16: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
16: [rank16]: Traceback (most recent call last):
16: [rank16]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
16: [rank16]:     main()
16: [rank16]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
16: [rank16]:     _run_hydra(
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
16: [rank16]:     _run_app(
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
16: [rank16]:     run_and_report(
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
16: [rank16]:     raise ex
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
16: [rank16]:     return func()
16: [rank16]:            ^^^^^^
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
16: [rank16]:     lambda: hydra.run(
16: [rank16]:             ^^^^^^^^^^
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
16: [rank16]:     _ = ret.return_value
16: [rank16]:         ^^^^^^^^^^^^^^^^
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
16: [rank16]:     raise self._return_value
16: [rank16]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
16: [rank16]:     ret.return_value = task_function(task_cfg)
16: [rank16]:                        ^^^^^^^^^^^^^^^^^^^^^^^
16: [rank16]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
16: [rank16]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
16: [rank16]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16: [rank16]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
16: [rank16]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
16: [rank16]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16: [rank16]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
16: [rank16]:     raise ValueError("Imaginary component {}".format(m))
16: [rank16]: ValueError: Imaginary component 0.0029952042492374167
63: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
63: [rank63]: Traceback (most recent call last):
63: [rank63]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
63: [rank63]:     main()
63: [rank63]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
63: [rank63]:     _run_hydra(
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
63: [rank63]:     _run_app(
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
63: [rank63]:     run_and_report(
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
63: [rank63]:     raise ex
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
63: [rank63]:     return func()
63: [rank63]:            ^^^^^^
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
63: [rank63]:     lambda: hydra.run(
63: [rank63]:             ^^^^^^^^^^
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
63: [rank63]:     _ = ret.return_value
63: [rank63]:         ^^^^^^^^^^^^^^^^
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
63: [rank63]:     raise self._return_value
63: [rank63]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
63: [rank63]:     ret.return_value = task_function(task_cfg)
63: [rank63]:                        ^^^^^^^^^^^^^^^^^^^^^^^
63: [rank63]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
63: [rank63]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
63: [rank63]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
63: [rank63]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
63: [rank63]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
63: [rank63]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
63: [rank63]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
63: [rank63]:     raise ValueError("Imaginary component {}".format(m))
63: [rank63]: ValueError: Imaginary component 0.0029952042492374167
48: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
48: [rank48]: Traceback (most recent call last):
48: [rank48]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
48: [rank48]:     main()
48: [rank48]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
48: [rank48]:     _run_hydra(
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
48: [rank48]:     _run_app(
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
48: [rank48]:     run_and_report(
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
48: [rank48]:     raise ex
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
48: [rank48]:     return func()
48: [rank48]:            ^^^^^^
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
48: [rank48]:     lambda: hydra.run(
48: [rank48]:             ^^^^^^^^^^
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
48: [rank48]:     _ = ret.return_value
48: [rank48]:         ^^^^^^^^^^^^^^^^
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
48: [rank48]:     raise self._return_value
48: [rank48]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
48: [rank48]:     ret.return_value = task_function(task_cfg)
48: [rank48]:                        ^^^^^^^^^^^^^^^^^^^^^^^
48: [rank48]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
48: [rank48]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
48: [rank48]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
48: [rank48]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
48: [rank48]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
48: [rank48]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
48: [rank48]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
48: [rank48]:     raise ValueError("Imaginary component {}".format(m))
48: [rank48]: ValueError: Imaginary component 0.0029952042492374167
41: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
41: [rank41]: Traceback (most recent call last):
41: [rank41]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
41: [rank41]:     main()
41: [rank41]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
41: [rank41]:     _run_hydra(
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
41: [rank41]:     _run_app(
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
41: [rank41]:     run_and_report(
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
41: [rank41]:     raise ex
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
41: [rank41]:     return func()
41: [rank41]:            ^^^^^^
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
41: [rank41]:     lambda: hydra.run(
41: [rank41]:             ^^^^^^^^^^
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
41: [rank41]:     _ = ret.return_value
41: [rank41]:         ^^^^^^^^^^^^^^^^
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
41: [rank41]:     raise self._return_value
41: [rank41]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
41: [rank41]:     ret.return_value = task_function(task_cfg)
41: [rank41]:                        ^^^^^^^^^^^^^^^^^^^^^^^
41: [rank41]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
41: [rank41]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
41: [rank41]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
41: [rank41]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
41: [rank41]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
41: [rank41]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
41: [rank41]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
41: [rank41]:     raise ValueError("Imaginary component {}".format(m))
41: [rank41]: ValueError: Imaginary component 0.0029952042492374167
37: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
37: [rank37]: Traceback (most recent call last):
37: [rank37]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
37: [rank37]:     main()
37: [rank37]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
37: [rank37]:     _run_hydra(
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
37: [rank37]:     _run_app(
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
37: [rank37]:     run_and_report(
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
37: [rank37]:     raise ex
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
37: [rank37]:     return func()
37: [rank37]:            ^^^^^^
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
37: [rank37]:     lambda: hydra.run(
37: [rank37]:             ^^^^^^^^^^
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
37: [rank37]:     _ = ret.return_value
37: [rank37]:         ^^^^^^^^^^^^^^^^
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
37: [rank37]:     raise self._return_value
37: [rank37]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
37: [rank37]:     ret.return_value = task_function(task_cfg)
37: [rank37]:                        ^^^^^^^^^^^^^^^^^^^^^^^
37: [rank37]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
37: [rank37]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
37: [rank37]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
37: [rank37]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
37: [rank37]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
37: [rank37]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
37: [rank37]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
37: [rank37]:     raise ValueError("Imaginary component {}".format(m))
37: [rank37]: ValueError: Imaginary component 0.0029952042492374167
34: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
34: [rank34]: Traceback (most recent call last):
34: [rank34]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
34: [rank34]:     main()
34: [rank34]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
34: [rank34]:     _run_hydra(
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
34: [rank34]:     _run_app(
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
34: [rank34]:     run_and_report(
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
34: [rank34]:     raise ex
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
34: [rank34]:     return func()
34: [rank34]:            ^^^^^^
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
34: [rank34]:     lambda: hydra.run(
34: [rank34]:             ^^^^^^^^^^
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
34: [rank34]:     _ = ret.return_value
34: [rank34]:         ^^^^^^^^^^^^^^^^
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
34: [rank34]:     raise self._return_value
34: [rank34]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
34: [rank34]:     ret.return_value = task_function(task_cfg)
34: [rank34]:                        ^^^^^^^^^^^^^^^^^^^^^^^
34: [rank34]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
34: [rank34]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
34: [rank34]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34: [rank34]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
34: [rank34]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
34: [rank34]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34: [rank34]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
34: [rank34]:     raise ValueError("Imaginary component {}".format(m))
34: [rank34]: ValueError: Imaginary component 0.0029952042492374167
 5: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 5: [rank5]: Traceback (most recent call last):
 5: [rank5]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 5: [rank5]:     main()
 5: [rank5]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 5: [rank5]:     _run_hydra(
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 5: [rank5]:     _run_app(
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 5: [rank5]:     run_and_report(
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 5: [rank5]:     raise ex
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 5: [rank5]:     return func()
 5: [rank5]:            ^^^^^^
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 5: [rank5]:     lambda: hydra.run(
 5: [rank5]:             ^^^^^^^^^^
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 5: [rank5]:     _ = ret.return_value
 5: [rank5]:         ^^^^^^^^^^^^^^^^
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 5: [rank5]:     raise self._return_value
 5: [rank5]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 5: [rank5]:     ret.return_value = task_function(task_cfg)
 5: [rank5]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 5: [rank5]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 5: [rank5]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 5: [rank5]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 5: [rank5]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 5: [rank5]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 5: [rank5]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 5: [rank5]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 5: [rank5]:     raise ValueError("Imaginary component {}".format(m))
 5: [rank5]: ValueError: Imaginary component 0.0029952042492374167
 8: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 8: [rank8]: Traceback (most recent call last):
 8: [rank8]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 8: [rank8]:     main()
 8: [rank8]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 8: [rank8]:     _run_hydra(
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 8: [rank8]:     _run_app(
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 8: [rank8]:     run_and_report(
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 8: [rank8]:     raise ex
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 8: [rank8]:     return func()
 8: [rank8]:            ^^^^^^
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 8: [rank8]:     lambda: hydra.run(
 8: [rank8]:             ^^^^^^^^^^
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 8: [rank8]:     _ = ret.return_value
 8: [rank8]:         ^^^^^^^^^^^^^^^^
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 8: [rank8]:     raise self._return_value
 8: [rank8]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 8: [rank8]:     ret.return_value = task_function(task_cfg)
 8: [rank8]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 8: [rank8]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 8: [rank8]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 8: [rank8]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 8: [rank8]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 8: [rank8]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 8: [rank8]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 8: [rank8]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 8: [rank8]:     raise ValueError("Imaginary component {}".format(m))
 8: [rank8]: ValueError: Imaginary component 0.0029952042492374167
10: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
10: [rank10]: Traceback (most recent call last):
10: [rank10]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
10: [rank10]:     main()
10: [rank10]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
10: [rank10]:     _run_hydra(
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
10: [rank10]:     _run_app(
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
10: [rank10]:     run_and_report(
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
10: [rank10]:     raise ex
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
10: [rank10]:     return func()
10: [rank10]:            ^^^^^^
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
10: [rank10]:     lambda: hydra.run(
10: [rank10]:             ^^^^^^^^^^
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
10: [rank10]:     _ = ret.return_value
10: [rank10]:         ^^^^^^^^^^^^^^^^
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
10: [rank10]:     raise self._return_value
10: [rank10]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
10: [rank10]:     ret.return_value = task_function(task_cfg)
10: [rank10]:                        ^^^^^^^^^^^^^^^^^^^^^^^
10: [rank10]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
10: [rank10]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
10: [rank10]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10: [rank10]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
10: [rank10]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
10: [rank10]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10: [rank10]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
10: [rank10]:     raise ValueError("Imaginary component {}".format(m))
10: [rank10]: ValueError: Imaginary component 0.0029952042492374167
35: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
35: [rank35]: Traceback (most recent call last):
35: [rank35]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
35: [rank35]:     main()
35: [rank35]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
35: [rank35]:     _run_hydra(
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
35: [rank35]:     _run_app(
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
35: [rank35]:     run_and_report(
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
35: [rank35]:     raise ex
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
35: [rank35]:     return func()
35: [rank35]:            ^^^^^^
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
35: [rank35]:     lambda: hydra.run(
35: [rank35]:             ^^^^^^^^^^
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
35: [rank35]:     _ = ret.return_value
35: [rank35]:         ^^^^^^^^^^^^^^^^
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
35: [rank35]:     raise self._return_value
35: [rank35]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
35: [rank35]:     ret.return_value = task_function(task_cfg)
35: [rank35]:                        ^^^^^^^^^^^^^^^^^^^^^^^
35: [rank35]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
35: [rank35]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
35: [rank35]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
35: [rank35]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
35: [rank35]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
35: [rank35]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
35: [rank35]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
35: [rank35]:     raise ValueError("Imaginary component {}".format(m))
35: [rank35]: ValueError: Imaginary component 0.0029952042492374167
 2: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
 2: [rank2]: Traceback (most recent call last):
 2: [rank2]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
 2: [rank2]:     main()
 2: [rank2]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
 2: [rank2]:     _run_hydra(
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
 2: [rank2]:     _run_app(
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
 2: [rank2]:     run_and_report(
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
 2: [rank2]:     raise ex
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
 2: [rank2]:     return func()
 2: [rank2]:            ^^^^^^
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
 2: [rank2]:     lambda: hydra.run(
 2: [rank2]:             ^^^^^^^^^^
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
 2: [rank2]:     _ = ret.return_value
 2: [rank2]:         ^^^^^^^^^^^^^^^^
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
 2: [rank2]:     raise self._return_value
 2: [rank2]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
 2: [rank2]:     ret.return_value = task_function(task_cfg)
 2: [rank2]:                        ^^^^^^^^^^^^^^^^^^^^^^^
 2: [rank2]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
 2: [rank2]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
 2: [rank2]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 2: [rank2]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
 2: [rank2]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
 2: [rank2]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 2: [rank2]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
 2: [rank2]:     raise ValueError("Imaginary component {}".format(m))
 2: [rank2]: ValueError: Imaginary component 0.0029952042492374167
32: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
32: [rank32]: Traceback (most recent call last):
32: [rank32]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
32: [rank32]:     main()
32: [rank32]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
32: [rank32]:     _run_hydra(
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
32: [rank32]:     _run_app(
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
32: [rank32]:     run_and_report(
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
32: [rank32]:     raise ex
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
32: [rank32]:     return func()
32: [rank32]:            ^^^^^^
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
32: [rank32]:     lambda: hydra.run(
32: [rank32]:             ^^^^^^^^^^
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
32: [rank32]:     _ = ret.return_value
32: [rank32]:         ^^^^^^^^^^^^^^^^
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
32: [rank32]:     raise self._return_value
32: [rank32]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
32: [rank32]:     ret.return_value = task_function(task_cfg)
32: [rank32]:                        ^^^^^^^^^^^^^^^^^^^^^^^
32: [rank32]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
32: [rank32]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
32: [rank32]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
32: [rank32]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
32: [rank32]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
32: [rank32]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
32: [rank32]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
32: [rank32]:     raise ValueError("Imaginary component {}".format(m))
32: [rank32]: ValueError: Imaginary component 0.0029952042492374167
60: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
60: [rank60]: Traceback (most recent call last):
60: [rank60]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
60: [rank60]:     main()
60: [rank60]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
60: [rank60]:     _run_hydra(
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
60: [rank60]:     _run_app(
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
60: [rank60]:     run_and_report(
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
60: [rank60]:     raise ex
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
60: [rank60]:     return func()
60: [rank60]:            ^^^^^^
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
60: [rank60]:     lambda: hydra.run(
60: [rank60]:             ^^^^^^^^^^
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
60: [rank60]:     _ = ret.return_value
60: [rank60]:         ^^^^^^^^^^^^^^^^
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
60: [rank60]:     raise self._return_value
60: [rank60]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
60: [rank60]:     ret.return_value = task_function(task_cfg)
60: [rank60]:                        ^^^^^^^^^^^^^^^^^^^^^^^
60: [rank60]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
60: [rank60]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
60: [rank60]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
60: [rank60]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
60: [rank60]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
60: [rank60]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
60: [rank60]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
60: [rank60]:     raise ValueError("Imaginary component {}".format(m))
60: [rank60]: ValueError: Imaginary component 0.0029952042492374167
40: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
40: [rank40]: Traceback (most recent call last):
40: [rank40]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
40: [rank40]:     main()
40: [rank40]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
40: [rank40]:     _run_hydra(
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
40: [rank40]:     _run_app(
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
40: [rank40]:     run_and_report(
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
40: [rank40]:     raise ex
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
40: [rank40]:     return func()
40: [rank40]:            ^^^^^^
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
40: [rank40]:     lambda: hydra.run(
40: [rank40]:             ^^^^^^^^^^
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
40: [rank40]:     _ = ret.return_value
40: [rank40]:         ^^^^^^^^^^^^^^^^
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
40: [rank40]:     raise self._return_value
40: [rank40]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
40: [rank40]:     ret.return_value = task_function(task_cfg)
40: [rank40]:                        ^^^^^^^^^^^^^^^^^^^^^^^
40: [rank40]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
40: [rank40]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
40: [rank40]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
40: [rank40]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
40: [rank40]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
40: [rank40]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
40: [rank40]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
40: [rank40]:     raise ValueError("Imaginary component {}".format(m))
40: [rank40]: ValueError: Imaginary component 0.0029952042492374167
11: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
11: [rank11]: Traceback (most recent call last):
11: [rank11]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
11: [rank11]:     main()
11: [rank11]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
11: [rank11]:     _run_hydra(
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
11: [rank11]:     _run_app(
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
11: [rank11]:     run_and_report(
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
11: [rank11]:     raise ex
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
11: [rank11]:     return func()
11: [rank11]:            ^^^^^^
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
11: [rank11]:     lambda: hydra.run(
11: [rank11]:             ^^^^^^^^^^
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
11: [rank11]:     _ = ret.return_value
11: [rank11]:         ^^^^^^^^^^^^^^^^
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
11: [rank11]:     raise self._return_value
11: [rank11]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
11: [rank11]:     ret.return_value = task_function(task_cfg)
11: [rank11]:                        ^^^^^^^^^^^^^^^^^^^^^^^
11: [rank11]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
11: [rank11]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
11: [rank11]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11: [rank11]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
11: [rank11]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
11: [rank11]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11: [rank11]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
11: [rank11]:     raise ValueError("Imaginary component {}".format(m))
11: [rank11]: ValueError: Imaginary component 0.0029952042492374167
31: Error executing job with overrides: ['trainer.num_nodes=16', 'trainer.devices=4', 'custom.sd_checkpoint_dir=/tmp/nemologs/stable-diffusion2-train-250501061129395518847-02/checkpoints/', 'custom.num_prompts=30000', 'custom.infer_start_step=2000', 'infer.batch_size=32']
31: [rank31]: Traceback (most recent call last):
31: [rank31]:   File "/workspace/sd/infer_and_eval.py", line 349, in <module>
31: [rank31]:     main()
31: [rank31]:   File "/workspace/NeMo/nemo/core/config/hydra_runner.py", line 129, in wrapper
31: [rank31]:     _run_hydra(
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 394, in _run_hydra
31: [rank31]:     _run_app(
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 457, in _run_app
31: [rank31]:     run_and_report(
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 223, in run_and_report
31: [rank31]:     raise ex
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 220, in run_and_report
31: [rank31]:     return func()
31: [rank31]:            ^^^^^^
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/utils.py", line 458, in <lambda>
31: [rank31]:     lambda: hydra.run(
31: [rank31]:             ^^^^^^^^^^
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/_internal/hydra.py", line 132, in run
31: [rank31]:     _ = ret.return_value
31: [rank31]:         ^^^^^^^^^^^^^^^^
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 260, in return_value
31: [rank31]:     raise self._return_value
31: [rank31]:   File "/usr/local/lib/python3.12/dist-packages/hydra/core/utils.py", line 186, in run_job
31: [rank31]:     ret.return_value = task_function(task_cfg)
31: [rank31]:                        ^^^^^^^^^^^^^^^^^^^^^^^
31: [rank31]:   File "/workspace/sd/infer_and_eval.py", line 320, in main
31: [rank31]:     result = run_eval(cfg, checkpoints[idx], fid_model, clip_model, local_id, device)
31: [rank31]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31: [rank31]:   File "/workspace/sd/infer_and_eval.py", line 193, in run_eval
31: [rank31]:     FID = calculate_frechet_distance(target_m, target_s, computed_m, computed_s)
31: [rank31]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31: [rank31]:   File "/workspace/sd/infer_and_eval_tools.py", line 80, in calculate_frechet_distance
31: [rank31]:     raise ValueError("Imaginary component {}".format(m))
31: [rank31]: ValueError: Imaginary component 0.0029952042492374167
++ date +%s
+ echo 'RUNANDTIME_STOP 1746099660'
RUNANDTIME_STOP 1746099660
+ set -e
